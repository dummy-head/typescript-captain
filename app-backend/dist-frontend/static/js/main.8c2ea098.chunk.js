(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{246:function(e,t,a){e.exports=a(536)},251:function(e,t,a){},257:function(e,t,a){},536:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(15),o=a.n(i),l=(a(251),a(7)),s=a(9),c=a(13),u=a(12),p=a(14),d=a(92),m=a(81),h=a(543),f=a(541),g=a(542),y=a(222),v=(a(257),a(103)),E="DEFAULT_REGISTRY_CHANGED";var b=Object(m.c)({registryReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case E:return Object(v.a)({},e,{defaultRegistryId:t.payload});default:return e}}}),k=(a(259),a(63)),D=(a(26),a(8)),C=(a(37),a(10)),O=(a(38),a(4)),S=(a(268),a(95)),T=a(526),w=a(528),N=a(93),A=a.n(N),R=function(){function e(){Object(l.a)(this,e)}return Object(s.a)(e,[{key:"init",value:function(){}},{key:"captureException",value:function(e){(e=e||"NULL")instanceof Error||(e=new Error(e+""))}},{key:"captureMessage",value:function(e){}}]),e}(),j=void 0,P=function(){return j||(j=new R),j},I=new(function(){function e(){Object(l.a)(this,e),this.OKAY=100,this.OKAY_BUILD_STARTED=101,this.STATUS_ERROR_GENERIC=1e3,this.STATUS_ERROR_CAPTAIN_NOT_INITIALIZED=1001,this.STATUS_ERROR_USER_NOT_INITIALIZED=1101,this.STATUS_ERROR_NOT_AUTHORIZED=1102,this.STATUS_ERROR_ALREADY_EXIST=1103,this.STATUS_ERROR_BAD_NAME=1104,this.STATUS_WRONG_PASSWORD=1105,this.STATUS_AUTH_TOKEN_INVALID=1106,this.VERIFICATION_FAILED=1107,this.UNKNOWN_ERROR=1999}return Object(s.a)(e,[{key:"createError",value:function(e,t){var a=new Error(t);return a.captainStatus=e,a.captainMessage=t,a}},{key:"eatUpPromiseRejection",value:function(){return function(e){P().captureException(e)}}}]),e}()),x=function(){function e(){Object(l.a)(this,e)}return Object(s.a)(e,null,[{key:"log",value:function(e){console.log(e)}},{key:"error",value:function(e){console.error(e)}},{key:"dev",value:function(e){Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_IS_DEBUG&&console.log(">>> ",e)}}]),e}(),L=function(){function e(t,a,n){Object(l.a)(this,e),this.baseUrl=t,this.authToken=a,this.onAuthFailure=n,this.GET="GET",this.POST="POST",this.isDestroyed=!1}return Object(s.a)(e,[{key:"createHeaders",value:function(){var e={};return this.authToken&&(e["x-captain-auth"]=this.authToken),e["x-namespace"]="captain",e}},{key:"setAuthToken",value:function(e){this.authToken=e}},{key:"destroy",value:function(){this.isDestroyed=!0}},{key:"fetch",value:function(e,t,a){var n=this;return function(){return n.fetchInternal(e,t,a).then(function(r){var i=r.data;return i.status===I.STATUS_AUTH_TOKEN_INVALID?n.onAuthFailure().then(function(){return n.fetchInternal(e,t,a).then(function(e){return e.data})}):i}).then(function(e){if(e.status!==I.OKAY&&e.status!==I.OKAY_BUILD_STARTED)throw I.createError(e.status||I.UNKNOWN_ERROR,e.description||"");return e}).then(function(e){return new Promise(function(t,a){if(!n.isDestroyed)return t(e.data)})}).catch(function(e){return x.error(e),new Promise(function(t,a){if(!n.isDestroyed)return a(e)})})}}},{key:"fetchInternal",value:function(e,t,a){if(e===this.GET)return this.getReq(t,a);if(e===this.POST)return this.postReq(t,a);throw new Error("Unknown method: "+e)}},{key:"getReq",value:function(e,t){return A.a.get(this.baseUrl+e,{params:t,headers:this.createHeaders()}).then(function(e){return e})}},{key:"postReq",value:function(e,t){return A.a.post(this.baseUrl+e,t,{headers:this.createHeaders()}).then(function(e){return e})}}]),e}(),M=(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_API_URL?Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_API_URL:"")+"/api/v2";x.dev("API URL: "+M);var V=function(){function e(){Object(l.a)(this,e);var t=this;this.http=new L(M,e.authToken,function(){return t.getAuthToken(e.lastKnownPassword)})}return Object(s.a)(e,[{key:"destroy",value:function(){this.http.destroy()}},{key:"setAuthToken",value:function(t){e.authToken=t,this.http.setAuthToken(t)}},{key:"getAuthToken",value:function(t){var a=this.http;e.lastKnownPassword=t;var n=this;return Promise.resolve().then(a.fetch(a.POST,"/login",{password:t})).then(function(e){n.setAuthToken(e.token)})}},{key:"getCaptainInfo",value:function(){var e=this.http;return Promise.resolve().then(e.fetch(e.GET,"/user/system/info",{}))}},{key:"updateRootDomain",value:function(e){var t=this.http;return Promise.resolve().then(t.fetch(t.POST,"/user/system/changerootdomain",{rootDomain:e}))}},{key:"enableRootSsl",value:function(e){var t=this.http;return Promise.resolve().then(t.fetch(t.POST,"/user/system/enablessl",{emailAddress:e}))}},{key:"forceSsl",value:function(e){var t=this.http;return Promise.resolve().then(t.fetch(t.POST,"/user/system/forcessl",{isEnabled:e}))}},{key:"getAllApps",value:function(){var e=this.http;return Promise.resolve().then(e.fetch(e.GET,"/user/apps/appDefinitions",{}))}},{key:"fetchBuildLogs",value:function(e){var t=this.http;return Promise.resolve().then(t.fetch(t.GET,"/user/apps/appData/"+e,{}))}},{key:"uploadAppData",value:function(e,t){var a=this.http,n=new FormData;return n.append("sourceFile",t),Promise.resolve().then(a.fetch(a.POST,"/user/apps/appData/"+e+"?detached=1",n))}},{key:"uploadCaptainDefinitionContent",value:function(e,t,a,n){var r=this.http;return Promise.resolve().then(r.fetch(r.POST,"/user/apps/appData/"+e+(n?"?detached=1":""),{captainDefinitionContent:JSON.stringify(t),gitHash:a}))}},{key:"updateConfigAndSave",value:function(e,t){var a=t.instanceCount,n=t.envVars,r=t.notExposeAsWebApp,i=t.forceSsl,o=t.volumes,l=t.ports,s=t.nodeId,c=t.appPushWebhook,u=t.customNginxConfig,p=t.preDeployFunction,d=this.http;return Promise.resolve().then(d.fetch(d.POST,"/user/apps/appDefinitions/update",{appName:e,instanceCount:a,notExposeAsWebApp:r,forceSsl:i,volumes:o,ports:l,customNginxConfig:u,appPushWebhook:c,nodeId:s,preDeployFunction:p,envVars:n}))}},{key:"registerNewApp",value:function(e,t){var a=this.http;return Promise.resolve().then(a.fetch(a.POST,"/user/apps/appDefinitions/register",{appName:e,hasPersistentData:t}))}},{key:"deleteApp",value:function(e){var t=this.http;return Promise.resolve().then(t.fetch(t.POST,"/user/apps/appDefinitions/delete",{appName:e}))}},{key:"enableSslForBaseDomain",value:function(e){var t=this.http;return Promise.resolve().then(t.fetch(t.POST,"/user/apps/appDefinitions/enablebasedomainssl",{appName:e}))}},{key:"attachNewCustomDomainToApp",value:function(e,t){var a=this.http;return Promise.resolve().then(a.fetch(a.POST,"/user/apps/appDefinitions/customdomain",{appName:e,customDomain:t}))}},{key:"enableSslForCustomDomain",value:function(e,t){var a=this.http;return Promise.resolve().then(a.fetch(a.POST,"/user/apps/appDefinitions/enablecustomdomainssl",{appName:e,customDomain:t}))}},{key:"removeCustomDomain",value:function(e,t){var a=this.http;return Promise.resolve().then(a.fetch(a.POST,"/user/apps/appDefinitions/removecustomdomain",{appName:e,customDomain:t}))}},{key:"getLoadBalancerInfo",value:function(){var e=this.http;return Promise.resolve().then(e.fetch(e.GET,"/user/system/loadbalancerinfo",{}))}},{key:"getNetDataInfo",value:function(){var e=this.http;return Promise.resolve().then(e.fetch(e.GET,"/user/system/netdata",{}))}},{key:"updateNetDataInfo",value:function(e){var t=this.http;return Promise.resolve().then(t.fetch(t.POST,"/user/system/netdata",{netDataInfo:e}))}},{key:"changePass",value:function(e,t){var a=this.http;return Promise.resolve().then(a.fetch(a.POST,"/user/changepassword",{oldPassword:e,newPassword:t}))}},{key:"getVersionInfo",value:function(){var e=this.http;return Promise.resolve().then(e.fetch(e.GET,"/user/system/versioninfo",{}))}},{key:"performUpdate",value:function(e){var t=this.http;return Promise.resolve().then(t.fetch(t.POST,"/user/system/versioninfo",{latestVersion:e}))}},{key:"getNginxConfig",value:function(){var e=this.http;return Promise.resolve().then(e.fetch(e.GET,"/user/system/nginxconfig",{}))}},{key:"setNginxConfig",value:function(e,t){var a=this.http;return Promise.resolve().then(a.fetch(a.POST,"/user/system/nginxconfig",{baseConfig:{customValue:e},captainConfig:{customValue:t}}))}},{key:"getUnusedImages",value:function(e){var t=this.http;return Promise.resolve().then(t.fetch(t.GET,"/user/apps/appDefinitions/unusedImages",{mostRecentLimit:e+""}))}},{key:"deleteImages",value:function(e){var t=this.http;return Promise.resolve().then(t.fetch(t.POST,"/user/apps/appDefinitions/deleteImages",{imageIds:e}))}},{key:"getDockerRegistries",value:function(){var e=this.http;return Promise.resolve().then(e.fetch(e.GET,"/user/registries",{}))}},{key:"enableSelfHostedDockerRegistry",value:function(){var e=this.http;return Promise.resolve().then(e.fetch(e.POST,"/user/system/selfhostregistry/enableregistry",{}))}},{key:"disableSelfHostedDockerRegistry",value:function(){var e=this.http;return Promise.resolve().then(e.fetch(e.POST,"/user/system/selfhostregistry/disableregistry",{}))}},{key:"addDockerRegistry",value:function(e){var t=this.http;return Promise.resolve().then(t.fetch(t.POST,"/user/registries/insert",Object(v.a)({},e)))}},{key:"updateDockerRegistry",value:function(e){var t=this.http;return Promise.resolve().then(t.fetch(t.POST,"/user/registries/update",Object(v.a)({},e)))}},{key:"deleteDockerRegistry",value:function(e){var t=this.http;return Promise.resolve().then(t.fetch(t.POST,"/user/registries/delete",{registryId:e}))}},{key:"setDefaultPushDockerRegistry",value:function(e){var t=this.http;return Promise.resolve().then(t.fetch(t.POST,"/user/registries/setpush",{registryId:e}))}},{key:"getAllNodes",value:function(){var e=this.http;return Promise.resolve().then(e.fetch(e.GET,"/user/system/nodes",{}))}},{key:"addDockerNode",value:function(e,t,a,n){var r=this.http;return Promise.resolve().then(r.fetch(r.POST,"/user/system/nodes",{nodeType:e,privateKey:t,remoteNodeIpAddress:a,captainIpAddress:n}))}}],[{key:"isLoggedIn",value:function(){return!!e.authToken}}]),e}();V.lastKnownPassword=Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_DEFAULT_PASSWORD?Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_DEFAULT_PASSWORD+"":"captain42",V.authToken=Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_IS_DEBUG?"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhIjp7Im5hbWVzcGFjZSI6ImNhcHRhaW4iLCJ0b2tlblZlcnNpb24iOiI5NmRjM2U1MC00ZDk3LTRkNmItYTIzMS04MmNiZjY0ZTA2NTYifSwiaWF0IjoxNTQ1OTg0MDQwLCJleHAiOjE1ODE5ODQwNDB9.uGJyhb2JYsdw9toyMKX28bLVuB0PhnS2POwEjKpchww":"";var B=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"handleClick",value:function(e){e.preventDefault(),this.props.onLinkClicked&&this.props.onLinkClicked()}},{key:"render",value:function(){var e=this;return r.a.createElement("a",{onClick:function(t){return e.handleClick(t)}},this.props.children)}}]),t}(n.Component),U=(a(47),a(23)),F=(a(46),a(21)),H=(a(33),a(18)),G=(a(74),a(39)),W=(a(40),a(16)),_=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).willUnmountSoon=!1,a.apiManager=new V,a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentWillUnmount",value:function(){this.willUnmountSoon=!0,this.apiManager.destroy()}}]),t}(n.Component),Y=(a(139),a(89)),z=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=r.a.createElement(O.a,{type:"loading",style:{fontSize:32},spin:!0});return r.a.createElement("div",{style:{width:"100%",textAlign:"center"}},r.a.createElement(Y.a,{style:{marginTop:60,marginBottom:60,width:"100%"},indicator:e,size:"large"}))}}]),t}(n.Component),K=(a(48),a(22)),q=function(){function e(){Object(l.a)(this,e)}return Object(s.a)(e,null,[{key:"toast",value:function(e){var t="Something bad happened.";if(e.captainStatus){var a=e.captainMessage||t;t="".concat(e.captainStatus," : ").concat(a)}K.a.error(t)}},{key:"createCatcher",value:function(){return function(t){e.toast(t)}}}]),e}(),J=W.a.Search,Z=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={userEmail:"",isLoading:!0,apiData:void 0},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.reFetchData()}},{key:"reFetchData",value:function(){var e=this;this.apiManager.getCaptainInfo().then(function(t){e.setState({isLoading:!1,apiData:t})}).catch(q.createCatcher())}},{key:"onForceSslClicked",value:function(){var e=this,t=window.location.href.startsWith("http://");G.a.confirm({title:"Force HTTPS",content:r.a.createElement("p",null,"Once Force HTTPS is activated, all HTTP traffic is redirected to HTTPS.",t?"Since this is a one-way action, and there is no revert, it is highly recommended that you test the HTTPS website first.":""," ","Do you still want to proceed?"),onOk:function(){e.apiManager.forceSsl(!0).then(function(){return new Promise(function(e,a){G.a.success({title:"Force HTTPS activated!",content:r.a.createElement("div",null,r.a.createElement("p",null,"All HTTP traffic is now redirected to HTTPS."," ",t?"You will have to login again as you will now be redirected to HTTPS website.":"")),onOk:function(){e()},onCancel:function(){e()}})})}).then(function(){t&&window.location.replace("https://"+e.state.apiData.rootDomain)}).catch(q.createCatcher())},onCancel:function(){}})}},{key:"onEnableSslClicked",value:function(){var e=this;Promise.resolve().then(function(){return new Promise(function(t,a){G.a.success({title:"Enable HTTPS",content:r.a.createElement("div",null,r.a.createElement("p",null,"Captain uses"," ",r.a.createElement("a",{href:"https://letsencrypt.org/",target:"_blank",rel:"noopener noreferrer"},"Let's Encrypt")," ","to provide free SSL Certificates (HTTPS). This email address is very important as Let's Encrypt uses it for validation purposes. Please provide a valid email here."),r.a.createElement("p",null,"IMPORTANT: Once you enable HTTPS, you cannot edit the root domain ever again. Make sure you use a good root domain. A good practice is to go one level deeper and setup your root domain. For example, if you own ",r.a.createElement("code",null,"example.com"),", use"," ",r.a.createElement("code",null,"*.captainroot.example.com")," as your root domain. This will allow you to better manage your subdomains, do not use ",r.a.createElement("code",null,"*.example.com")," as your root domain."),r.a.createElement(W.a,{placeholder:"your@email.com",type:"email",onChange:function(t){return e.setState({userEmail:(t.target.value||"").trim()})}})),onOk:function(){t(e.state.userEmail||"")},onCancel:function(){t(void 0)}})})}).then(function(t){return void 0===t?"IGNORE":(e.setState({isLoading:!0}),e.apiManager.enableRootSsl(t))}).then(function(t){if("IGNORE"!==t)return e.reFetchData(),G.a.success({title:"Root Domain HTTPS activated!",content:r.a.createElement("div",null,r.a.createElement("p",null,"You can now use"," ",r.a.createElement("code",null,"https://"+e.state.apiData.rootDomain),". Next step is to Force HTTPS to disallow plain HTTP traffic."))}),!0}).catch(q.createCatcher())}},{key:"updateRootDomain",value:function(e){this.apiManager.updateRootDomain(e).then(function(t){G.a.success({title:"Root Domain Updated",content:r.a.createElement("div",null,r.a.createElement("p",null,"Click Ok to get redirected to your new root domain. You need to log in again.")),onOk:function(){window.location.replace("http://captain."+e)}})}).catch(q.createCatcher())}},{key:"render",value:function(){return this.state.isLoading?r.a.createElement(z,null):r.a.createElement("div",null,this.createInitialSetup(),r.a.createElement("br",null),this.createSetupPanel())}},{key:"createSetupPanel",value:function(){var e=this;return r.a.createElement(D.a,null,r.a.createElement(C.a,{span:14,offset:5},r.a.createElement(U.a,{title:"Captain Root Domain Configurations"},r.a.createElement("div",null,r.a.createElement("p",null,"The very first thing that Captain needs is a root domain. For example, if you own ",r.a.createElement("i",null,"myawesomecompany.com"),", you can use"," ",r.a.createElement("i",null,"captain.myawesomecompany.com")," or"," ",r.a.createElement("i",null,"foo.bar.myawesomecompany.com")," as your root domain. First, you need to make sure that the ip address for all subdomains of the root domain resolve to the Captain ip address. To do this, go to the DNS settings in your domain provider website, and set a wild card A entry.",r.a.createElement("br",null)," For example: ",r.a.createElement("b",null," Type:")," ",r.a.createElement("u",null,"A"),","," ",r.a.createElement("b",null,"Name (or host):")," ",r.a.createElement("u",null,"*.captain"),",",r.a.createElement("b",null," IP (or Points to):")," ",r.a.createElement("u",null,"110.120.130.140")," where this is the IP address of your captain machine."),r.a.createElement("p",null,r.a.createElement("i",null,"NOTE: DNS settings might take several hours to take into effect. See"," ",r.a.createElement("a",{href:"https://ca.godaddy.com/help/what-factors-affect-dns-propagation-time-1746",target:"_blank",rel:"noopener noreferrer"}," ","here")," ","for more details."))),r.a.createElement("hr",null),r.a.createElement("br",null),r.a.createElement(D.a,null,r.a.createElement("div",null,r.a.createElement("p",null,"For example, if you set ",r.a.createElement("code",null,"*.captainroot.example.com")," ","to the IP address of your server, just enter"," ",r.a.createElement("code",null,"captainroot.example.com")," in the box below:"),r.a.createElement("br",null),r.a.createElement("div",null,r.a.createElement(J,{addonBefore:"[wildcard]\xa0.",disabled:e.state.apiData.hasRootSsl,placeholder:"captainroot.example.com",defaultValue:e.state.apiData.rootDomain+"",enterButton:"Update Domain",onSearch:function(t){return e.updateRootDomain(t)}}))),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(D.a,{type:"flex",justify:"end"},r.a.createElement(F.a,{title:"Using Let's Encrypt Free Service"},r.a.createElement(H.a,{disabled:e.state.apiData.hasRootSsl||!e.state.apiData.rootDomain,onClick:function(){return e.onEnableSslClicked()}},"Enable HTTPS")),"\xa0\xa0",r.a.createElement(F.a,{title:"Redirect all HTTP to HTTPS"},r.a.createElement(H.a,{disabled:!e.state.apiData.hasRootSsl||e.state.apiData.forceSsl,onClick:function(){return e.onForceSslClicked()}},"Force HTTPS"))),r.a.createElement("div",null)))))}},{key:"createInitialSetup",value:function(){return this.state.apiData.hasRootSsl?r.a.createElement("div",null):r.a.createElement(D.a,null,r.a.createElement(C.a,{span:18,offset:3},r.a.createElement(U.a,{title:"Captain Initial Setup"},r.a.createElement("div",null,r.a.createElement("h3",null,"Congratulations! \ud83c\udf89\ud83c\udf89"),r.a.createElement("p",null,r.a.createElement("b",null)," You have installed CaptainDuckDuck successfully! You can set up your CaptainDuckDuck instance in two ways:"),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("b",null,"Command Line Tool (RECOMMENDED): ")," On your local machine, simply run",r.a.createElement("br",null),r.a.createElement("code",null,"npm i -g captainduckduck"),r.a.createElement("br",null),"followed by",r.a.createElement("br",null),r.a.createElement("code",null,"captainduckduck serversetup"),". Then follow the guide."),r.a.createElement("li",null,r.a.createElement("b",null,"Use the panel below: ")," This is a non-guided version of the Command Line method. Use this method only for the purpose of experimentation."))))))}}]),t}(_),X=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){V.isLoggedIn()?this.props.history.push("/dashboard"):this.props.history.push("/login")}},{key:"render",value:function(){return r.a.createElement("div",null)}}]),t}(n.Component),Q=(a(79),a(45)),$=(a(359),a(174)),ee=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("p",null,"Setting up Docker Registry is ",r.a.createElement("b",null,"only required")," if you plan to run your Captain on a cluster. For single node Captain deployments, Docker Registry is not recommended as it makes deployment significantly slower."),r.a.createElement($.a,null,r.a.createElement($.a.Panel,{header:"More info",key:"1"},r.a.createElement("p",null,"Docker registry is a repository for your built images. It is similar to Github, or Bitbucker, with private repositories. However, instead of source code, it contains the built artifacts for your application. It is required for cluster mode, as other nodes need to access the built image in order for your application to run on them."),r.a.createElement("p",null,"Captain provides two methods for you to setup your docker registry:"),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("b",null,"Self hosted Docker Registry:")," This is the simplest way to setup a docker registry. Captain creates an instance of Docker Registry on the main machine and it manages the registry for you. However, it has its own limitation. If your main machine is destroyed, your local images will be lost. In most cases, this is not a disaster as you can re-deploy your apps from your source code.",r.a.createElement("br",null)),r.a.createElement("li",null,r.a.createElement("b",null,"Remote Docker Registry:")," This approach relies on a remote service to act as your Docker Registry. Using this approach, you'll have a more reliable cluster, assuming the third party service you use is reliable! There are multiple private Docker Registry services available: Google Container Registry, Amazon EC2 Container Registry, Quay and etc. Note that this approach costs you money.")))))}}]),t}(n.Component),te=(a(154),a(56)),ae=function(e){return JSON.parse(JSON.stringify(e))},ne=function(){var e=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:[a-zA-Z\\d]*(?:;[a-zA-Z\\d]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(e,"g")},re=te.a.Option,ie=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={isInEditMode:!1,newSelectedDefaultId:""},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getDefaultRegText",value:function(){for(var e=this.props.apiData.registries,t=this.props.apiData.defaultPushRegistryId,a=0;a<e.length;a++){var n=e[a];if(n.id===t)return n.registryUser+" @ "+n.registryDomain}return"disabled push"}},{key:"getAllOptions",value:function(){return ae(this.props.apiData.registries).map(function(e){return r.a.createElement(re,{value:e.id,key:e.id},e.registryUser+" @ "+e.registryDomain)})}},{key:"render",value:function(){var e=this,t=this;return r.a.createElement("div",null,r.a.createElement(G.a,{title:"Edit Push Registry",okText:"Save and Update",onCancel:function(){return t.setState({isInEditMode:!1})},onOk:function(){t.setState({isInEditMode:!1}),t.props.changeDefault(t.state.newSelectedDefaultId)},visible:t.state.isInEditMode},r.a.createElement("p",null,"Default Docker Registry is the registry that will be used to store your newly built images. You can select ",r.a.createElement("code",null,"disabled push")," ","if you don't want to push your newly built images to any docker registry. Keep in mind that if you use ",r.a.createElement("code",null,"disabled push"),", cluster nodes (if you happen to have more than one server) will not be able to run your applications."),r.a.createElement("p",null,"Change the default Docker Registry:"),r.a.createElement(te.a,{defaultValue:this.props.apiData.defaultPushRegistryId||"none",style:{width:300},onChange:function(t){"none"==t?e.setState({newSelectedDefaultId:""}):e.setState({newSelectedDefaultId:t})}},r.a.createElement(re,{value:"none"},"disabled push"),t.getAllOptions()),r.a.createElement("div",{style:{marginTop:20},className:t.state.newSelectedDefaultId?"hide-on-demand":""},r.a.createElement(Q.a,{showIcon:!0,type:"warning",message:"If you have a cluster (more than one server), you need to have a default push registry. If you only have one single server, disabling default push registry is fine."}))),r.a.createElement("h3",null,"Default Push Registry"),r.a.createElement("p",null,"Docker Registry for Pushing New Images:"," ",r.a.createElement(B,{onLinkClicked:function(){t.setState({isInEditMode:!0,newSelectedDefaultId:t.props.apiData.defaultPushRegistryId||""})}},r.a.createElement("code",null,this.getDefaultRegText())," ",r.a.createElement(O.a,{type:"edit"}))))}}]),t}(n.Component),oe=(a(120),a(68)),le=function e(){Object(l.a)(this,e)};le.LOCAL_REG="LOCAL_REG",le.REMOTE_REG="REMOTE_REG";var se=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={modalShowing:void 0,remoteRegistryToEdit:void 0,registryIdToDelete:void 0},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"deleteRegistry",value:function(e){e!==this.props.apiData.defaultPushRegistryId?this.setState({registryIdToDelete:e,modalShowing:"DELETING_MODAL"}):G.a.warn({title:"Cannot Delete Default Push",content:r.a.createElement("div",null,"This registry is set to be the default push. You cannot delete the default push registry. To remove, first you need to change the default push registry to another registry, or completely disable the default push registry. Then, come back and delete this.")})}},{key:"editRegistry",value:function(e){e.registryType!==le.LOCAL_REG?this.setState({modalShowing:"EDITING_MODAL",remoteRegistryToEdit:ae(e)}):K.a.warn("You cannot edit the self hosted registry. It is managed by Captain.")}},{key:"getCols",value:function(){var e=this;return[{title:"User",dataIndex:"registryUser"},{title:"Password",dataIndex:"registryPassword",render:function(e){return r.a.createElement("span",null,"Edit to see.")}},{title:"Domain",dataIndex:"registryDomain"},{title:"Image Prefix",dataIndex:"registryImagePrefix"},{title:"Actions",dataIndex:"id",render:function(t,a){return r.a.createElement("span",null,r.a.createElement(B,{onLinkClicked:function(){e.editRegistry(a)}},r.a.createElement(O.a,{type:"form"})),"\xa0\xa0\xa0\xa0",r.a.createElement(B,{onLinkClicked:function(){e.deleteRegistry(a.id)}},r.a.createElement(O.a,{type:"delete"})))}}]}},{key:"createEditModalContent",value:function(){var e=this;return r.a.createElement("div",{style:{maxWidth:360}},r.a.createElement(W.a,{addonBefore:"Username",placeholder:"username | email@gmail.com",type:"email",value:e.state.remoteRegistryToEdit.registryUser,onChange:function(t){var a=ae(e.state.remoteRegistryToEdit);a.registryUser=t.target.value.trim(),e.setState({remoteRegistryToEdit:a})}}),r.a.createElement("div",{style:{height:20}}),r.a.createElement(W.a,{addonBefore:"Password",placeholder:"mypassword",type:"text",value:e.state.remoteRegistryToEdit.registryPassword,onChange:function(t){var a=ae(e.state.remoteRegistryToEdit);a.registryPassword=t.target.value,e.setState({remoteRegistryToEdit:a})}}),r.a.createElement("div",{style:{height:20}}),r.a.createElement(W.a,{addonBefore:"Domain",placeholder:"registry-1.docker.io",type:"text",value:e.state.remoteRegistryToEdit.registryDomain,onChange:function(t){var a=ae(e.state.remoteRegistryToEdit);a.registryDomain=t.target.value.trim(),e.setState({remoteRegistryToEdit:a})}}),r.a.createElement("div",{style:{height:20}}),r.a.createElement(W.a,{addonBefore:"Image Prefix",placeholder:"username",addonAfter:r.a.createElement(F.a,{title:"Your images will be tagged as RegistryDomain/ImagePrefix/ImageName. For most providers, Image Prefix is exactly your username, unless the field DOMAIN is specific to you, in that case, this prefix is empty."},r.a.createElement(O.a,{type:"info-circle"})),type:"text",value:e.state.remoteRegistryToEdit.registryImagePrefix,onChange:function(t){var a=ae(e.state.remoteRegistryToEdit);a.registryImagePrefix=t.target.value.trim(),e.setState({remoteRegistryToEdit:a})}}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(G.a,{title:"Confirm Delete",okText:"Delete Registry",onCancel:function(){return e.setState({modalShowing:void 0})},onOk:function(){e.setState({modalShowing:void 0}),e.props.deleteRegistry(e.state.registryIdToDelete)},visible:"DELETING_MODAL"===e.state.modalShowing},"Are you sure you want to remote this registry from your list. You will no longer be able to push to or pull from this registry."),r.a.createElement(G.a,{title:"Edit Registry",okText:"Save and Update",onCancel:function(){return e.setState({modalShowing:void 0})},onOk:function(){e.setState({modalShowing:void 0}),e.props.editRegistry(ae(e.state.remoteRegistryToEdit))},visible:"EDITING_MODAL"===e.state.modalShowing},e.state.remoteRegistryToEdit?e.createEditModalContent():r.a.createElement("div",null)),r.a.createElement("h3",null,"Docker Registries"),r.a.createElement("div",null,r.a.createElement(oe.a,{rowKey:"id",pagination:!1,columns:this.getCols(),dataSource:this.props.apiData.registries})))}}]),t}(n.Component),ce=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={modalShowing:void 0,remoteRegistryToAdd:a.getPlainRegistryInfo()},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getPlainRegistryInfo",value:function(){return{id:"",registryUser:"",registryPassword:"",registryDomain:"",registryImagePrefix:"",registryType:le.REMOTE_REG}}},{key:"render",value:function(){var e=this,t=this.props.apiData.registries.map(function(e){return e.registryType}).indexOf(le.LOCAL_REG)>=0;return r.a.createElement("div",null,r.a.createElement(G.a,{title:"Self-Hosted Registry",okText:"Enable Self-Hosted Registry",onCancel:function(){return e.setState({modalShowing:void 0})},onOk:function(){e.setState({modalShowing:void 0}),e.props.addDockerRegistry({registryType:le.LOCAL_REG})},visible:"ADDING_LOCAL"===e.state.modalShowing},r.a.createElement("p",null,'You can read more about this type of registry on the page behind this modal, specifically under "More Info" section. Do you want to proceed and enable self-hosted Docker Registry?')),r.a.createElement(G.a,{title:"Remote Registry",okText:"Add Remote Registry",onCancel:function(){return e.setState({modalShowing:void 0})},onOk:function(){e.setState({modalShowing:void 0}),e.props.addDockerRegistry(e.state.remoteRegistryToAdd)},visible:"ADDING_REMOTE"===e.state.modalShowing},r.a.createElement("p",null,'You can read more about this type of registry on the page behind this modal, specifically under "More Info" section.'),r.a.createElement("div",{style:{height:20}}),r.a.createElement("div",{style:{maxWidth:360}},r.a.createElement(W.a,{addonBefore:"Username",placeholder:"username | email@gmail.com",type:"email",value:e.state.remoteRegistryToAdd.registryUser,onChange:function(t){var a=ae(e.state.remoteRegistryToAdd);a.registryUser=t.target.value.trim(),e.setState({remoteRegistryToAdd:a})}}),r.a.createElement("div",{style:{height:20}}),r.a.createElement(W.a,{addonBefore:"Password",placeholder:"mypassword",type:"text",value:e.state.remoteRegistryToAdd.registryPassword,onChange:function(t){var a=ae(e.state.remoteRegistryToAdd);a.registryPassword=t.target.value,e.setState({remoteRegistryToAdd:a})}}),r.a.createElement("div",{style:{height:20}}),r.a.createElement(W.a,{addonBefore:"Domain",placeholder:"registry-1.docker.io",type:"text",value:e.state.remoteRegistryToAdd.registryDomain,onChange:function(t){var a=ae(e.state.remoteRegistryToAdd);a.registryDomain=t.target.value.trim(),e.setState({remoteRegistryToAdd:a})}}),r.a.createElement("div",{style:{height:20}}),r.a.createElement(W.a,{addonBefore:"Image Prefix",placeholder:"username",addonAfter:r.a.createElement(F.a,{title:"Your images will be tagged as RegistryDomain/ImagePrefix/ImageName. For most providers, Image Prefix is exactly your username, unless the field DOMAIN is specific to you, in that case, this prefix is empty."},r.a.createElement(O.a,{type:"info-circle"})),type:"text",value:e.state.remoteRegistryToAdd.registryImagePrefix,onChange:function(t){var a=ae(e.state.remoteRegistryToAdd);a.registryImagePrefix=t.target.value.trim(),e.setState({remoteRegistryToAdd:a})}}))),r.a.createElement("div",{className:t?"hide-on-demand":""},r.a.createElement(D.a,{type:"flex",justify:"end"},r.a.createElement(H.a,{onClick:function(){return e.setState({modalShowing:"ADDING_LOCAL"})}},"Add Self-Hosted Registry"))),r.a.createElement("div",{style:{height:20}}),r.a.createElement(D.a,{type:"flex",justify:"end"},r.a.createElement(H.a,{onClick:function(){return e.setState({modalShowing:"ADDING_REMOTE",remoteRegistryToAdd:e.getPlainRegistryInfo()})}},"Add Remote Registry")))}}]),t}(n.Component),ue=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={apiData:void 0},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"fetchData",value:function(){var e=this;this.setState({apiData:void 0}),this.apiManager.getDockerRegistries().then(function(t){e.setState({apiData:t}),e.props.emitDefaultRegistryChanged(t.defaultPushRegistryId)}).catch(q.createCatcher())}},{key:"changeDefault",value:function(e){var t=this;this.setState({apiData:void 0}),this.apiManager.setDefaultPushDockerRegistry(e).then(function(){K.a.success("Default push registry successfully changed.")}).catch(q.createCatcher()).then(function(){t.fetchData()})}},{key:"deleteRegistry",value:function(e){var t=this,a=t.state.apiData.registries.map(function(t){return t.registryType===le.LOCAL_REG&&t.id===e}).indexOf(!0)>=0;this.setState({apiData:void 0}),(a?this.apiManager.disableSelfHostedDockerRegistry():this.apiManager.deleteDockerRegistry(e)).then(function(){K.a.success("Registry deleted.")}).catch(q.createCatcher()).then(function(){t.fetchData()})}},{key:"editRegistry",value:function(e){var t=this;this.setState({apiData:void 0}),this.apiManager.updateDockerRegistry(e).then(function(){K.a.success("Registry updated.")}).catch(q.createCatcher()).then(function(){t.fetchData()})}},{key:"addDockerRegistry",value:function(e){var t=this;this.setState({apiData:void 0}),(e.registryType===le.LOCAL_REG?t.apiManager.enableSelfHostedDockerRegistry():t.apiManager.addDockerRegistry(e)).then(function(){K.a.success("Docker registry successfully added!")}).catch(q.createCatcher()).then(function(){t.fetchData()})}},{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e=this;return this.state.apiData?r.a.createElement("div",null,r.a.createElement(ee,null),r.a.createElement("div",{style:{height:60}}),r.a.createElement("div",{style:{textAlign:"center"},className:0===this.state.apiData.registries.length?"":"hide-on-demand"},r.a.createElement(Q.a,{type:"info",message:"No registries is added yet. Go ahead and add your first registry!"})),r.a.createElement("div",{className:this.state.apiData.registries.length>0?"":"hide-on-demand"},r.a.createElement(ie,{apiData:e.state.apiData,changeDefault:function(t){e.changeDefault(t)}}),r.a.createElement("div",{style:{height:40}}),r.a.createElement(se,{apiData:e.state.apiData,deleteRegistry:function(t){e.deleteRegistry(t)},editRegistry:function(t){e.editRegistry(t)}})),r.a.createElement("div",{style:{height:50}}),r.a.createElement(ce,{apiData:e.state.apiData,addDockerRegistry:function(t){return e.addDockerRegistry(t)}})):r.a.createElement(z,null)}}]),t}(_);var pe=Object(d.b)(function(e){return{defaultRegistryId:e.registryReducer.defaultRegistryId}},{emitDefaultRegistryChanged:function(e){return{type:E,payload:e}}})(ue),de=(a(458),a(229)),me=(a(198),a(72)),he=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={nodeToAdd:{remoteNodeIpAddress:"",captainIpAddress:"",nodeType:"worker",privateKey:""}},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"changeModel",value:function(e,t){var a=ae(this.state.nodeToAdd);a[e]=t,this.setState({nodeToAdd:a})}},{key:"render",value:function(){var e=this,t=e.state.nodeToAdd;return r.a.createElement("div",null,r.a.createElement(U.a,{style:{marginTop:16},type:"inner",title:"Attach New Node"},r.a.createElement(D.a,{type:"flex",justify:"space-between"},r.a.createElement(C.a,{span:11},r.a.createElement(W.a,{style:{marginBottom:10},addonBefore:"New node IP Address",placeholder:"123.123.123.123",type:"text",value:t.remoteNodeIpAddress,onChange:function(t){return e.changeModel("remoteNodeIpAddress",t.target.value)}})),r.a.createElement(C.a,{span:11},r.a.createElement(W.a,{style:{marginBottom:10},addonBefore:"Captain IP Address",placeholder:"123.123.123.123",type:"text",value:t.captainIpAddress,onChange:function(t){return e.changeModel("captainIpAddress",t.target.value)}})),r.a.createElement(C.a,{span:24,style:{marginTop:10}},r.a.createElement("div",{style:{paddingBottom:5}},"\xa0SSH Private Key for ",r.a.createElement("b",null,"root")," user"),r.a.createElement(W.a.TextArea,{style:{marginBottom:20},className:"code-input",rows:6,placeholder:"-----BEGIN RSA PRIVATE KEY-----\nMIICWwIBAAKBgQDArfs81aizq8ckg16e+ewFgJg7J...",value:t.privateKey,onChange:function(t){return e.changeModel("privateKey",t.target.value)}}))),r.a.createElement(D.a,{type:"flex",justify:"end"},r.a.createElement(me.a.Group,{defaultValue:"a",buttonStyle:"outline",style:{marginBottom:20},value:t.nodeType,onChange:function(t){return e.changeModel("nodeType",t.target.value)}},r.a.createElement(me.a.Button,{value:"worker"},"Join as worker node"),r.a.createElement(me.a.Button,{value:"manager"},"Join as manager node")),"\xa0",r.a.createElement(F.a,{title:"Tip: For every 5 workers, add 2 manager nodes, keeping manager node count as an odd number. Therefore, use worker node for the first 4 nodes you add to your cluster."},r.a.createElement(O.a,{style:{paddingTop:8,paddingLeft:8},type:"info-circle"}))),r.a.createElement(D.a,{type:"flex",justify:"end"},r.a.createElement(H.a,{type:"primary",onClick:function(){return e.props.onAddNodeClicked(e.state.nodeToAdd)}},r.a.createElement(O.a,{type:"cluster"})," \xa0 Join Cluster"))))}}]),t}(n.Component),fe=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={apiData:void 0},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"fetchData",value:function(){var e=this;e.setState({apiData:void 0}),e.apiManager.getAllNodes().then(function(t){e.setState({apiData:t})}).catch(q.createCatcher())}},{key:"addNode",value:function(e){var t=this;t.setState({apiData:void 0}),t.apiManager.addDockerNode(e.nodeType,e.privateKey,e.remoteNodeIpAddress,e.captainIpAddress).then(function(){K.a.success("Node added successfully!")}).catch(q.createCatcher()).then(function(e){t.fetchData()})}},{key:"componentDidMount",value:function(){this.fetchData()}},{key:"createNodes",value:function(){return(this.state.apiData.nodes||[]).map(function(e){return r.a.createElement("div",{key:e.nodeId,style:{paddingTop:15,paddingBottom:20,paddingRight:20,paddingLeft:20,marginBottom:40,borderRadius:5,border:"1px solid #dddddd",backgroundColor:"#fcfcfc"}},r.a.createElement(D.a,{type:"flex",justify:"center"},r.a.createElement("b",null,"Node ID:\xa0\xa0")," ",e.nodeId),r.a.createElement("hr",null),r.a.createElement("div",{style:{height:10}}),r.a.createElement(D.a,null,r.a.createElement(C.a,{span:12},r.a.createElement("b",null,"Type: "),e.isLeader?"Leader (Main Node)":e.type),r.a.createElement(C.a,{span:12},r.a.createElement("b",null,"IP: "),e.ip)),r.a.createElement(D.a,null,r.a.createElement(C.a,{span:12},r.a.createElement("b",null,"State: "),e.state),r.a.createElement(C.a,{span:12},r.a.createElement("b",null,"Status: "),e.status)),r.a.createElement("br",null),r.a.createElement(D.a,null,r.a.createElement(C.a,{span:12},r.a.createElement("b",null,"RAM: "),(e.memoryBytes/1073741824).toFixed(2)," GB"),r.a.createElement(C.a,{span:12},r.a.createElement("b",null,"OS: "),e.operatingSystem)),r.a.createElement(D.a,null,r.a.createElement(C.a,{span:12},r.a.createElement("b",null,"CPU: "),(e.nanoCpu/1e9).toFixed(0)," cores"),r.a.createElement(C.a,{span:12},r.a.createElement("b",null,"Architecture: "),e.architecture)),r.a.createElement("br",null),r.a.createElement(D.a,null,r.a.createElement(C.a,{span:12},r.a.createElement("b",null,"Hostname: "),e.hostname),r.a.createElement(C.a,{span:12},r.a.createElement("b",null,"Docker Version: "),e.dockerEngineVersion)))})}},{key:"render",value:function(){var e=this;return this.state.apiData?r.a.createElement("div",null,this.props.defaultRegistryId?r.a.createElement(he,{onAddNodeClicked:function(t){e.addNode(t)}}):r.a.createElement("div",null,r.a.createElement(Q.a,{type:"warning",showIcon:!0,message:"Cannot add more nodes as no default push registry is set. To add more nodes and create a cluster, you first need to add a docker registry and set it as the default push registry."})),r.a.createElement("div",{style:{height:50}}),r.a.createElement(de.a,{type:"horizontal"},r.a.createElement("h4",null,"Current Cluster Nodes")),r.a.createElement("div",{style:{height:30}}),r.a.createElement(D.a,{type:"flex",justify:"center"},r.a.createElement(C.a,{span:14},e.createNodes()))):r.a.createElement(z,null)}}]),t}(_);var ge=Object(d.b)(function(e){return{defaultRegistryId:e.registryReducer.defaultRegistryId}})(fe),ye=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(D.a,{type:"flex",justify:"center"},r.a.createElement(C.a,{span:20},r.a.createElement(U.a,{title:"Docker Registry Configuration"},r.a.createElement(pe,null)))),r.a.createElement("div",{style:{height:35}}),r.a.createElement(D.a,{type:"flex",justify:"center"},r.a.createElement(C.a,{span:20},r.a.createElement(U.a,{title:"Nodes"},r.a.createElement(ge,null)))))}},{key:"componentDidMount",value:function(){}}]),t}(n.Component),ve=(a(111),a(49)),Ee=a(230),be=a.n(Ee),ke=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={hasPersistency:!1,appName:""},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onCreateNewAppClicked",value:function(){this.props.onCreateNewAppClicked(this.state.appName,this.state.hasPersistency)}},{key:"onCreateOneClickAppClicked",value:function(){this.props.onCreateOneClickAppClicked()}},{key:"render",value:function(){var e=this;return r.a.createElement(D.a,null,r.a.createElement(C.a,{span:10,offset:7},r.a.createElement(U.a,{title:r.a.createElement("span",null,r.a.createElement(O.a,{type:"plus-circle"}),"\xa0\xa0\xa0Create A New App")},r.a.createElement(D.a,null,r.a.createElement(be.a,{placeholder:"my-amazing-app",enterButton:"Create New App",onChange:function(t){return e.setState({appName:t.target.value})},onSearch:function(t){return e.onCreateNewAppClicked()}})),r.a.createElement("br",null),r.a.createElement(D.a,{type:"flex",justify:"end"},r.a.createElement(ve.a,{onChange:function(t){return e.setState({hasPersistency:!!t.target.checked})}},"Has Persistent Data"),"\xa0\xa0",r.a.createElement(F.a,{title:"Mostly used for databases, see docs for details."},r.a.createElement("a",{href:"https://captainduckduck.com/docs/app-configuration.html#persistent-or-not",target:"_blank",rel:"noopener noreferrer"},r.a.createElement("span",null,r.a.createElement(O.a,{type:"question-circle",theme:"filled"}))))),r.a.createElement("br",null),r.a.createElement("hr",null),r.a.createElement("br",null),r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement("p",null,"Or Select From"),r.a.createElement(H.a,{onClick:function(){return e.onCreateOneClickAppClicked()}},"One-Click Apps/Databases")))))}}]),t}(n.Component),De=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={searchTerm:""},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onAppClicked",value:function(e){this.props.history.push("/apps/details/".concat(e))}},{key:"createColumns",value:function(){var e=this;return[{title:"App Name",dataIndex:"appName",key:"appName",render:function(t){return r.a.createElement(B,{onLinkClicked:function(){return e.onAppClicked(t)}},t)}},{title:"Persistent Data\t",dataIndex:"hasPersistentData",key:"hasPersistentData",align:"center",render:function(e){return e?r.a.createElement("span",null,r.a.createElement(O.a,{type:"check"})):r.a.createElement("span",null)}},{title:"Exposed Webapp",dataIndex:"notExposeAsWebApp",key:"notExposeAsWebApp",align:"center",render:function(e){return e?r.a.createElement("span",null):r.a.createElement("span",null,r.a.createElement(O.a,{type:"check"}))}},{title:"Instance Count",dataIndex:"instanceCount",key:"instanceCount",align:"center"},{title:"Open in Browser",dataIndex:"notExposeAsWebApp",key:"openInBrowser",align:"center",render:function(t,a){return t?r.a.createElement("span",null):r.a.createElement("a",{href:"http"+(a.hasDefaultSubDomainSsl?"s":"")+"://"+a.appName+"."+e.props.rootDomain,target:"_blank",rel:"noopener noreferrer"},r.a.createElement(O.a,{type:"link"})," ")}}]}},{key:"render",value:function(){var e=this,t=e.props.apps.filter(function(t){return!e.state.searchTerm||t.appName.indexOf(e.state.searchTerm)>=0});return r.a.createElement(D.a,null,r.a.createElement(C.a,{span:18,offset:3,style:{paddingBottom:300}},r.a.createElement(U.a,{extra:r.a.createElement(W.a,{placeholder:"Search by Name",type:"text",onChange:function(t){return e.setState({searchTerm:(t.target.value||"").trim()})}}),title:r.a.createElement("span",null,r.a.createElement(O.a,{type:"code"}),"\xa0\xa0\xa0Your Apps")},r.a.createElement(D.a,null,r.a.createElement(oe.a,{rowKey:"appName",columns:e.createColumns(),dataSource:t,pagination:!1,size:"middle"})))))}}]),t}(n.Component),Ce=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={isLoading:!0,apiData:void 0},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onCreateOneClickAppClicked",value:function(){this.props.history.push("/apps/oneclick/")}},{key:"onCreateNewAppClicked",value:function(e,t){var a=this;Promise.resolve().then(function(){return a.setState({isLoading:!0}),a.apiManager.registerNewApp(e,t)}).then(function(e){a.reFetchData()}).catch(q.createCatcher())}},{key:"render",value:function(){var e=this;return e.state.isLoading?r.a.createElement(z,null):r.a.createElement("div",null,r.a.createElement(ke,{onCreateNewAppClicked:function(t,a){e.onCreateNewAppClicked(t,a)},onCreateOneClickAppClicked:function(){e.onCreateOneClickAppClicked()}}),r.a.createElement("div",{style:{height:25}}),e.state.apiData.appDefinitions.length>0?r.a.createElement(De,{history:this.props.history,defaultNginxConfig:this.state.apiData.defaultNginxConfig,apps:this.state.apiData.appDefinitions,rootDomain:this.state.apiData.rootDomain}):r.a.createElement("div",null))}},{key:"componentDidMount",value:function(){this.reFetchData()}},{key:"reFetchData",value:function(){var e=this;e.setState({isLoading:!0}),this.apiManager.getAllApps().then(function(t){e.setState({isLoading:!1,apiData:t})}).catch(q.createCatcher())}}]),t}(_),Oe=(a(471),a(244)),Se=(a(182),a(94)),Te=W.a.Search,we=function(e){function t(e){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).call(this,e))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,this.createHttpSettingsContent())}},{key:"reFetchData",value:function(){this.props.reFetchData()}},{key:"enableDefaultHttps",value:function(){var e=this;return this.props.setLoading(!0),Promise.resolve().then(function(){return e.props.apiManager.enableSslForBaseDomain(e.props.apiData.appDefinition.appName)}).then(function(){K.a.success("HTTPS is now enabled for your app")}).then(function(){e.reFetchData()}).catch(q.createCatcher())}},{key:"onConnectNewDomainClicked",value:function(e){var t=this;return this.props.setLoading(!0),Promise.resolve().then(function(){return t.props.apiManager.attachNewCustomDomainToApp(t.props.apiData.appDefinition.appName,e)}).then(function(){K.a.success("New domain is now successfully connected!")}).then(function(){t.reFetchData()}).catch(q.createCatcher())}},{key:"onEnableCustomDomainSslClicked",value:function(e){var t=this;return this.props.setLoading(!0),Promise.resolve().then(function(){return t.props.apiManager.enableSslForCustomDomain(t.props.apiData.appDefinition.appName,e)}).then(function(){K.a.success("HTTPS is successfully activated for your domain!")}).then(function(){t.reFetchData()}).catch(q.createCatcher())}},{key:"onRemoveCustomDomainClicked",value:function(e){var t=this;return this.props.setLoading(!0),Promise.resolve().then(function(){return t.props.apiManager.removeCustomDomain(t.props.apiData.appDefinition.appName,e)}).then(function(){K.a.success("Your custom domain is successfully removed!")}).then(function(){t.reFetchData()}).catch(q.createCatcher())}},{key:"createCustomDomainRows",value:function(){var e=this,t=this.props.apiData.appDefinition.customDomain||[],a=[];return t.forEach(function(t){var n=r.a.createElement(D.a,{key:t.publicDomain,style:{marginTop:15}},r.a.createElement(H.a.Group,{size:"small"},r.a.createElement(F.a,{title:t.hasSsl?"Already activated":"Click to activate HTTPS for this domain"},r.a.createElement(H.a,{disabled:t.hasSsl,onClick:function(){e.onEnableCustomDomainSslClicked(t.publicDomain)},type:"primary"},"Enable HTTPS")),r.a.createElement(H.a,{style:{marginRight:20},onClick:function(){e.onRemoveCustomDomainClicked(t.publicDomain)}},"Remove")),r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"http://"+t.publicDomain},t.publicDomain));a.push(n)}),a}},{key:"onEditDefaultNginxConfigClicked",value:function(){var e=ae(this.props.apiData);e.appDefinition.customNginxConfig=this.props.apiData.defaultNginxConfig,this.props.updateApiData(e)}},{key:"createCustomNginx",value:function(){var e=this,t=this.props.apiData.appDefinition.customNginxConfig;return t?r.a.createElement("div",null,r.a.createElement("p",null,"Note that templates are build using EJS template pattern. Do not change the areas between <&percnt; and &percnt;> unless you really know what you're doing! To revert to default, simply remove all the content."),r.a.createElement(W.a.TextArea,{style:{fontFamily:"monospace"},onChange:function(t){var a=ae(e.props.apiData);a.appDefinition.customNginxConfig=t.target.value,e.props.updateApiData(a)},rows:17,defaultValue:t})):r.a.createElement("div",null,r.a.createElement(H.a,{type:"default",onClick:function(){return e.onEditDefaultNginxConfigClicked()}},"Edit Default Nginx Configurations"))}},{key:"createHttpDetailsSettingsContent",value:function(){var e=this,t=this.props.apiData.appDefinition,a=this.props.apiData.rootDomain;return r.a.createElement("div",null,r.a.createElement(D.a,null,r.a.createElement("p",null,"Your app is available to public at:"),r.a.createElement(F.a,{title:t.hasDefaultSubDomainSsl?"Already activated":"Click to activate HTTPS for this domain"},r.a.createElement(H.a,{disabled:t.hasDefaultSubDomainSsl,style:{marginRight:20},onClick:function(){e.enableDefaultHttps()},type:"primary",size:"small"},"Enable HTTPS")),r.a.createElement("a",{href:"http"+(t.hasDefaultSubDomainSsl?"s":"")+"://"+t.appName+"."+a,target:"_blank",rel:"noopener noreferrer"},"http"+(t.hasDefaultSubDomainSsl?"s":"")+"://"+t.appName+"."+a)),r.a.createElement("br",null),r.a.createElement("hr",null),r.a.createElement("br",null),r.a.createElement(D.a,null,r.a.createElement(C.a,{span:15},r.a.createElement(Te,{placeholder:"www.the-best-app-in-the-world.com",enterButton:"Connect New Domain",onSearch:function(t){return e.onConnectNewDomainClicked(t)}})),"\xa0\xa0\xa0",r.a.createElement(F.a,{title:"Make sure the new domain points to this IP, otherwise verification will fail."},r.a.createElement("span",null,r.a.createElement(O.a,{style:{marginTop:9},type:"info-circle"})))),r.a.createElement("br",null),this.createCustomDomainRows(),r.a.createElement("br",null),r.a.createElement("br",null),this.createCustomNginx(),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(D.a,null,r.a.createElement(ve.a,{onChange:function(t){var a=ae(e.props.apiData);a.appDefinition.forceSsl=!!t.target.checked,e.props.updateApiData(a)}},"Enforce HTTPS by redirecting all HTTP traffic to HTTPS"),r.a.createElement(F.a,{title:"Forcing HTTPS causes domains without HTTPS to malfunction. Make sure you enable HTTPS for the domain you want to use, before enabling Force HTTPS option."},r.a.createElement(O.a,{type:"info-circle"}))))}},{key:"createHttpSettingsContent",value:function(){var e=this,t=this.props.apiData.appDefinition;return r.a.createElement("div",null,r.a.createElement("p",null,"Your app is internally available as"," ",r.a.createElement("code",null,"srv-captain--",t.appName)," to other Captain apps. In case of web-app, it is accessible via"," ",r.a.createElement("code",null,"http://srv-captain--"+t.appName)," from other apps."),r.a.createElement("br",null),r.a.createElement(ve.a,{defaultChecked:this.props.apiData.appDefinition.notExposeAsWebApp,onChange:function(t){var a=ae(e.props.apiData);a.appDefinition.notExposeAsWebApp=!!t.target.checked,e.props.updateApiData(a)}},"Do not expose as web-app"),r.a.createElement(F.a,{title:"Use this if you don't want your app be externally available."},r.a.createElement(O.a,{type:"info-circle"})),r.a.createElement("div",{style:{height:35}}),t.notExposeAsWebApp?r.a.createElement("div",null):this.createHttpDetailsSettingsContent())}}]),t}(n.Component),Ne=(a(474),a(231)),Ae=(W.a.Search,function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={dummyVar:void 0,forceEditableInstanceCount:!1,envVarBulkEdit:!1,bulkVals:"",forceEditableNodeId:!1},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"parseEnvVars",value:function(e){var t={};return e.toString().split("\n").forEach(function(e,a){var n=e.match(/^\s*([\w.-]+)\s*=\s*(.*)?\s*$/);if(null!=n){var r=n[1],i=n[2]||"",o=i?i.length:0;o>0&&'"'===i.charAt(0)&&'"'===i.charAt(o-1)&&(i=i.replace(/\\n/gm,"\n")),i=i.replace(/(^['"]|['"]$)/g,"").trim(),t[r]=i}}),t}},{key:"convertEnvVarsToBulk",value:function(e){return e.map(function(e){var t=e.value;return t.indexOf("\n")>=0&&(t='"'+t.split("\n").join("\\n")+'"'),e.key+"="+t}).join("\n")}},{key:"createEnvVarSection",value:function(){var e=this,t=this.props.apiData.appDefinition.envVars||[];if(e.state.envVarBulkEdit)return r.a.createElement("div",null,r.a.createElement(D.a,{style:{paddingBottom:12}},r.a.createElement(C.a,{span:24},r.a.createElement(W.a.TextArea,{className:"code-input",placeholder:"key1=value1\nkey2=value2",rows:7,value:e.state.bulkVals?e.state.bulkVals:e.convertEnvVarsToBulk(t),onChange:function(t){var a=ae(e.props.apiData),n=e.parseEnvVars(t.target.value),r=[];Object.keys(n).forEach(function(e){r.push({key:e,value:n[e]})}),a.appDefinition.envVars=r,e.props.updateApiData(a),e.setState({bulkVals:t.target.value})}}))));var a=t.map(function(t,a){return r.a.createElement(D.a,{style:{paddingBottom:12},key:""+a},r.a.createElement(C.a,{span:8},r.a.createElement(W.a,{className:"code-input",placeholder:"key",value:t.key,type:"text",onChange:function(t){var n=ae(e.props.apiData);n.appDefinition.envVars[a].key=t.target.value,e.props.updateApiData(n)}})),r.a.createElement(C.a,{style:{paddingLeft:12},span:16},r.a.createElement(W.a.TextArea,{className:"code-input",placeholder:"value",rows:1,value:t.value,onChange:function(t){var n=ae(e.props.apiData);n.appDefinition.envVars[a].value=t.target.value,e.props.updateApiData(n)}})))});return r.a.createElement("div",null,a,r.a.createElement("br",null),r.a.createElement(H.a,{type:"default",onClick:function(){return e.addEnvVarClicked()}},"Add Key/Value Pair"))}},{key:"createPortRows",value:function(){var e=this;return(this.props.apiData.appDefinition.ports||[]).map(function(t,a){return r.a.createElement(D.a,{style:{paddingBottom:12},key:""+a},r.a.createElement(C.a,{span:12},r.a.createElement(F.a,{title:"Make sure the port is not already used!"},r.a.createElement(W.a,{addonBefore:"Server Port",placeholder:"5050",value:t.hostPort?t.hostPort+"":"",type:"number",onChange:function(t){var n=ae(e.props.apiData),r=Number(t.target.value.trim());n.appDefinition.ports[a].hostPort=r>0?r:0,e.props.updateApiData(n)}}))),r.a.createElement(C.a,{style:{paddingLeft:12},span:12},r.a.createElement(W.a,{addonBefore:"Container Port",placeholder:"6060",value:t.containerPort?t.containerPort+"":"",onChange:function(t){var n=ae(e.props.apiData),r=Number(t.target.value.trim());n.appDefinition.ports[a].containerPort=r>0?r:0,e.props.updateApiData(n)}})))})}},{key:"createVolRows",value:function(){var e=this;return(this.props.apiData.appDefinition.volumes||[]).map(function(t,a){return r.a.createElement(D.a,{style:{paddingBottom:12},key:""+a},r.a.createElement(C.a,{span:8},r.a.createElement(W.a,{addonBefore:"Path in App",className:"code-input",placeholder:"/var/www/html",value:t.containerPath,type:"text",onChange:function(t){var n=ae(e.props.apiData);n.appDefinition.volumes[a].containerPath=t.target.value,e.props.updateApiData(n)}})),r.a.createElement(C.a,{style:{paddingLeft:12},span:8,className:t.hostPath?"hide-on-demand":""},r.a.createElement(W.a,{addonBefore:"Label",className:"code-input",placeholder:"some-name",value:t.volumeName,onChange:function(t){var n=ae(e.props.apiData);n.appDefinition.volumes[a].volumeName=t.target.value,e.props.updateApiData(n)}})),r.a.createElement(C.a,{style:{paddingLeft:12},span:8,className:t.hostPath?"":"hide-on-demand"},r.a.createElement(F.a,{title:"IMPORTANT: Ensure Host Path exists before assigning it here"},r.a.createElement(W.a,{addonBefore:"Path on Host",className:"code-input",placeholder:"/host/path/exists",value:t.hostPath,onChange:function(t){var n=ae(e.props.apiData);n.appDefinition.volumes[a].hostPath=t.target.value,e.props.updateApiData(n)}}))),r.a.createElement(C.a,{style:{paddingLeft:12},span:8},r.a.createElement(H.a,{type:"dashed",onClick:function(){var t=ae(e.props.apiData);t.appDefinition.volumes[a].hostPath=t.appDefinition.volumes[a].hostPath?"":"/",e.props.updateApiData(t)}},t.hostPath?"Let Captain manage path":"Set specific host path")))})}},{key:"createVolSection",value:function(){var e=this,t=this,a=this.props.apiData.appDefinition;return a.hasPersistentData?r.a.createElement("div",null,r.a.createElement("h4",null,"Persistent Directories \xa0",r.a.createElement("a",{href:"https://captainduckduck.com/docs/app-configuration.html#persistent-or-not",target:"_blank",rel:"noopener noreferrer"},r.a.createElement(O.a,{type:"info-circle"}))),r.a.createElement("div",{className:a.volumes&&a.volumes.length?"hide-on-demand":""},r.a.createElement("i",null,"Currently, this app does not have any persistent directories.")),this.createVolRows(),r.a.createElement("br",null),r.a.createElement(H.a,{type:"default",onClick:function(){return e.addVolumeClicked()}},"Add Persistent Directory"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(D.a,null,r.a.createElement(C.a,{span:6,style:{width:300}},r.a.createElement(F.a,{title:"Leave empty for automatic placement"},r.a.createElement(W.a,{addonBefore:"Node ID",className:"code-input",value:a.nodeId?a.nodeId:"",disabled:!this.state.forceEditableNodeId,onChange:function(e){var a=ae(t.props.apiData);a.appDefinition.nodeId=e.target.value,t.props.updateApiData(a)}}))),r.a.createElement(C.a,{span:12,style:{paddingLeft:24}},r.a.createElement(F.a,{title:"WARNING: Changing Node ID causes the content of your persistent directories to be deleted!"},r.a.createElement(H.a,{type:"default",disabled:this.state.forceEditableNodeId,onClick:function(){return e.setState({forceEditableNodeId:!0})}},"Edit")))),r.a.createElement("br",null),r.a.createElement("br",null)):r.a.createElement("div",null)}},{key:"render",value:function(){var e=this,t=this,a=this.props.apiData.appDefinition;return r.a.createElement("div",null,r.a.createElement("h4",null,"Environmental Variables:"),r.a.createElement(D.a,{align:"middle",justify:"end",type:"flex"},r.a.createElement("h5",null,"Bulk Edit\xa0"," ",r.a.createElement(Ne.a,{onChange:function(e){t.setState({envVarBulkEdit:e,bulkVals:""})}}))),r.a.createElement("div",{className:a.envVars&&a.envVars.length?"hide-on-demand":""},r.a.createElement("i",null,"Currently, this app does not have any custom environmental variables yet.")),this.createEnvVarSection(),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("h4",null,"Port Mapping \xa0",r.a.createElement("a",{href:"https://captainduckduck.com/docs/app-configuration.html#port-mapping",target:"_blank",rel:"noopener noreferrer"},r.a.createElement(O.a,{type:"info-circle"}))),r.a.createElement("div",{className:a.ports&&a.ports.length?"hide-on-demand":""},r.a.createElement("i",null,"Currently, this app does not have any custom port mapping.")),this.createPortRows(),r.a.createElement("br",null),r.a.createElement(H.a,{type:"default",onClick:function(){return e.addPortMappingClicked()}},"Add Port Mapping"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),this.createVolSection(),r.a.createElement("br",null),r.a.createElement(D.a,null,r.a.createElement(C.a,{span:6,style:{width:300}},r.a.createElement(F.a,{title:"Number of running instances of this app"},r.a.createElement(W.a,{addonBefore:"Instance Count",type:"number",defaultValue:a.instanceCount+"",disabled:a.hasPersistentData&&!this.state.forceEditableInstanceCount,onChange:function(t){var a=ae(e.props.apiData);a.appDefinition.instanceCount=Number(t.target.value),e.props.updateApiData(a)}}))),r.a.createElement(C.a,{span:6},r.a.createElement("div",{style:{paddingLeft:24},className:a.hasPersistentData?"":"hide-on-demand"},r.a.createElement(F.a,{title:"Multiple instances of apps with persistent data can be very dangerous and bug prone as they can be accessing the same file on the disk resulting in data corruption. Edit the instance count only if you understand the risk."},r.a.createElement(H.a,{type:"default",disabled:this.state.forceEditableInstanceCount,onClick:function(){return e.setState({forceEditableInstanceCount:!0})}},"Edit"))))),r.a.createElement(D.a,null,r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("h4",null,"Pre-Deploy Script",r.a.createElement("a",{style:{paddingLeft:10},href:"https://captainduckduck.com/docs/pre-deploy-script.html",target:"_blank",rel:"noopener noreferrer"},r.a.createElement(O.a,{type:"info-circle"}))),r.a.createElement(W.a.TextArea,{spellCheck:!1,autoCorrect:"off",autoComplete:"off",autoCapitalize:"off",className:"code-input",placeholder:"var preDeployFunction = function (captainAppObj, dockerUpdateObject) ...",rows:4,value:a.preDeployFunction?a.preDeployFunction:"",onChange:function(t){var a=ae(e.props.apiData);a.appDefinition.preDeployFunction=t.target.value,e.props.updateApiData(a)}})))}},{key:"addPortMappingClicked",value:function(){var e=ae(this.props.apiData);e.appDefinition.ports=e.appDefinition.ports||[],e.appDefinition.ports.push({containerPort:0,hostPort:0}),this.props.updateApiData(e)}},{key:"addEnvVarClicked",value:function(){var e=ae(this.props.apiData);e.appDefinition.envVars=e.appDefinition.envVars||[],e.appDefinition.envVars.push({key:"",value:""}),this.props.updateApiData(e)}},{key:"addVolumeClicked",value:function(){var e=ae(this.props.apiData);e.appDefinition.volumes=e.appDefinition.volumes||[],e.appDefinition.volumes.push({containerPath:"",volumeName:""}),this.props.updateApiData(e)}},{key:"reFetchData",value:function(){this.props.reFetchData()}}]),t}(n.Component)),Re=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={isAppBuilding:!1,expandedLogs:!!a.props.buildLogRecreationId,buildLogs:"",lastLineNumberPrinted:-1e4},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentWillUnmount",value:function(){this.fetchBuildLogsInterval&&clearInterval(this.fetchBuildLogsInterval)}},{key:"fetchBuildLogs",value:function(){var e=this;this.apiManager.fetchBuildLogs(this.props.appName).then(function(t){e.state.isAppBuilding&&!t.isAppBuilding&&e.props.onAppBuildFinished(),e.setState({isAppBuilding:t.isAppBuilding}),t.isAppBuilding&&e.setState({expandedLogs:!0});var a=t.logs.lines,n=t.logs.firstLineNumber,r=0;n>e.state.lastLineNumberPrinted?n<0?r=-n:e.setState({buildLogs:e.state.buildLogs+"[[ TRUNCATED ]]\n"}):r=e.state.lastLineNumberPrinted-n,e.setState({lastLineNumberPrinted:n+a.length});for(var i=!1,o=e.state.buildLogs,l=ne(),s=r;s<a.length;s++){o+=(a[s]||"").trim().replace(l,"")+"\n",i=!0}e.setState({buildLogs:o}),i&&setTimeout(function(){var e=document.getElementById("buildlog-text-id");e&&(e.scrollTop=e.scrollHeight)},100)}).catch(q.createCatcher())}},{key:"componentDidMount",value:function(){var e=this;this.fetchBuildLogs(),this.fetchBuildLogsInterval=setInterval(function(){e.fetchBuildLogs()},2e3)}},{key:"onExpandLogClicked",value:function(){this.setState({expandedLogs:!this.state.expandedLogs})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(D.a,null,r.a.createElement("div",{className:this.state.isAppBuilding?"":"hide-on-demand"},r.a.createElement(Q.a,{message:r.a.createElement("span",null,"\xa0\xa0",r.a.createElement(Y.a,{indicator:r.a.createElement(O.a,{type:"loading",style:{fontSize:24},spin:!0}),size:"default"}),"\xa0\xa0\xa0\xa0\xa0\xa0 Building the image. This might take a few minutes..."),type:"info"}))),r.a.createElement("div",{style:{height:20}}),r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(B,{onLinkClicked:function(){e.onExpandLogClicked()}},r.a.createElement("h4",{className:"unselectable-span"},r.a.createElement(O.a,{type:this.state.expandedLogs?"up-circle":"down-circle"}),"\xa0\xa0",this.state.expandedLogs?"Hide":"View"," Build Logs"))),r.a.createElement("div",{className:this.state.isAppBuilding||this.state.expandedLogs?"":"hide-on-demand",style:{padding:5}},r.a.createElement("div",{id:"buildlog-text-id",style:{overflow:"scroll",height:250,border:"2px solid #cccccc",backgroundColor:"#f6f6f6",borderRadius:5,padding:10,fontSize:"90%"}},r.a.createElement("pre",null,e.state.buildLogs)))))}}]),t}(_),je=(a(538),a(242)),Pe=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).beforeUpload=function(e){return!1},a.handleChange=function(e){if(e.fileList.length>1)K.a.error("You can only upload one TAR file! Remove the currently selected file first.");else{if(0===e.fileList.length)return a.setState({fileToBeUploaded:void 0}),void K.a.info("File removed");var t=e.fileList[0];t.name.indexOf(".tar")<0?K.a.error("You can only upload a TAR file!"):a.setState({fileToBeUploaded:t})}},a.state={fileToBeUploaded:void 0},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"startUploadAndDeploy",value:function(){var e=this;Promise.resolve().then(function(){return e.apiManager.uploadAppData(e.props.appName,e.state.fileToBeUploaded.originFileObj)}).then(function(){e.props.onUploadSucceeded()}).catch(q.createCatcher())}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(D.a,{type:"flex",justify:"center"},r.a.createElement(C.a,{span:12},r.a.createElement(je.a.Dragger,{name:"files",accept:"*/*",multiple:!1,fileList:this.state.fileToBeUploaded?[this.state.fileToBeUploaded]:void 0,listType:"text",onChange:this.handleChange,beforeUpload:this.beforeUpload,action:"//"},r.a.createElement("p",{className:"ant-upload-drag-icon"},r.a.createElement(O.a,{type:"inbox"})),r.a.createElement("p",{className:"ant-upload-text"},"Click or drag TAR file to this area to upload"),r.a.createElement("p",{className:"ant-upload-hint"},"Must contain ",r.a.createElement("code",null,"captain-definition")," file.")))),r.a.createElement(D.a,{type:"flex",justify:"center"},r.a.createElement(H.a,{style:{marginTop:40},disabled:!this.state.fileToBeUploaded,onClick:function(){return e.startUploadAndDeploy()},type:"primary",size:"large"},"Upload & Deploy")))}}]),t}(_),Ie=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("form",{action:"/",autoComplete:"off"},r.a.createElement(D.a,{gutter:20},r.a.createElement(C.a,{span:12},r.a.createElement(W.a,{style:{marginBottom:20},value:this.props.gitRepoValues.repo,addonBefore:"Repository",placeholder:"github.com/someone/something",type:"url",spellCheck:!1,autoCorrect:"off",autoComplete:"off",autoCapitalize:"off",onChange:function(t){var a=ae(e.props.gitRepoValues);a.repo=t.target.value,e.props.updateRepoInfo(a)}})),r.a.createElement(C.a,{span:12},r.a.createElement(W.a,{style:{marginBottom:20},value:this.props.gitRepoValues.branch,addonBefore:r.a.createElement("span",null,"Branch\xa0\xa0\xa0\xa0"),placeholder:"master",type:"text",spellCheck:!1,autoCorrect:"off",autoComplete:"off",autoCapitalize:"off",onChange:function(t){var a=ae(e.props.gitRepoValues);a.branch=t.target.value,e.props.updateRepoInfo(a)}})),r.a.createElement(C.a,{span:12},r.a.createElement(W.a,{style:{marginBottom:20},value:this.props.gitRepoValues.user,addonBefore:r.a.createElement("span",null,"Username\xa0"),placeholder:"myemail@gmail.com",type:"email",onChange:function(t){var a=ae(e.props.gitRepoValues);a.user=t.target.value,e.props.updateRepoInfo(a)}})),r.a.createElement(C.a,{span:12},r.a.createElement(W.a,{style:{marginBottom:20},value:this.props.gitRepoValues.password,addonBefore:"Password",placeholder:"githubpassword",spellCheck:!1,autoCorrect:"off",autoComplete:"off",autoCapitalize:"off",type:"text",onChange:function(t){var a=ae(e.props.gitRepoValues);a.password=t.target.value,e.props.updateRepoInfo(a)}})))))}}]),t}(n.Component);function xe(e,t){window.scrollTo(0,e),t.scrollTo({top:e,behavior:"smooth"})}var Le=function(e){var t=document.getElementById("main-content-layout");(t?t.scrollTop:0)<=120||(e?setTimeout(function(){xe(0,t)},e):xe(0,t))},Me=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getPlaceHolderValue",value:function(){return'{\n    "schemaVersion" :2 ,\n    "imageName" : "mysql:5.7\n}'}},{key:"convertDataToCaptainDefinition",value:function(e){return e.trim()}}]),t}(function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={userEnteredValue:"",uploadInProcess:!1},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"startDeploy",value:function(e){var t=this;Promise.resolve().then(function(){return t.setState({uploadInProcess:!0}),t.apiManager.uploadCaptainDefinitionContent(t.props.appName,JSON.parse(e),"",!0)}).then(function(){t.setState({userEnteredValue:""}),t.props.onUploadSucceeded()}).catch(q.createCatcher()).then(function(){t.setState({uploadInProcess:!1})})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{style:{padding:16}},r.a.createElement(D.a,null,r.a.createElement(W.a.TextArea,{className:"code-input",placeholder:e.getPlaceHolderValue(),rows:7,value:e.state.userEnteredValue,onChange:function(t){e.setState({userEnteredValue:t.target.value})}})),r.a.createElement("div",{style:{height:20}}),r.a.createElement(D.a,{type:"flex",justify:"end"},r.a.createElement(H.a,{disabled:e.state.uploadInProcess||!e.state.userEnteredValue.trim(),type:"primary",onClick:function(){return e.startDeploy(e.convertDataToCaptainDefinition(e.state.userEnteredValue))}},"Deploy Now")))}}]),t}(_)),Ve=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getPlaceHolderValue",value:function(){return"# Derived from official mysql image (our base image)\nFROM mysql:5.7\n# Add a database\nENV MYSQL_DATABASE company"}},{key:"convertDataToCaptainDefinition",value:function(e){var t={schemaVersion:2,dockerfileLines:e.trim().split("\n")};return JSON.stringify(t)}}]),t}(Me),Be=a(235),Ue=a.n(Be),Fe=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getCols",value:function(){var e=this;return[{title:"State",key:"revertColumn",align:"center",dataIndex:"version",render:function(t,a){return t===e.props.deployedVersion?r.a.createElement(F.a,{title:"Current Version"},r.a.createElement(O.a,{type:"check-circle",theme:"twoTone",twoToneColor:"#52c41a"})):a.deployedImageName?r.a.createElement(B,{onLinkClicked:function(){return e.onRollbackClicked(a)}},r.a.createElement(F.a,{title:"Revert to this version"},r.a.createElement("span",null,r.a.createElement(O.a,{type:"retweet"})))):r.a.createElement(F.a,{title:"Failed deploy"},r.a.createElement(O.a,{type:"exclamation-circle"}))}},{title:"Version",align:"center",dataIndex:"version"},{title:"Deploy Time",dataIndex:"timeStamp",render:function(e){return r.a.createElement(F.a,{title:Ue()(new Date(e)).fromNow()},r.a.createElement("span",null,new Date(e).toLocaleString()))}},{title:"Image Name",dataIndex:"deployedImageName"},{title:"git hash",dataIndex:"gitHash",render:function(e,t){var a=e||"";return a.length>12&&(a=a.substr(0,10)+"..."),r.a.createElement(F.a,{title:e},r.a.createElement("div",{className:"code-input"},a||"n/a"))}}]}},{key:"onRollbackClicked",value:function(e){var t=this,a=e.deployedImageName,n=r.a.createElement("span",null,"If you had previously deleted this image explicitly through disk cleanup, \n      this revert process will fail.",r.a.createElement("br",null),r.a.createElement("br",null),"Do you want to continue with rolling back your app to ",r.a.createElement("code",null,a),"?");a.indexOf("/")>0&&(n=r.a.createElement("span",null,"".concat(a," appears to be hosted on Docker Registry. \n        Make sure you have not deleted this image from the repository since it was originally deployed. \n        Deletion usually does not happen automatically, so if you have not deleted the image intentionally, \n        you don't need to worry about this."),r.a.createElement("br",null),r.a.createElement("br",null),"Do you want to continue with rolling back your app to ",r.a.createElement("code",null,a),"?")),G.a.confirm({title:"Rollback?",content:n,onOk:function(){t.props.onVersionRollbackRequested(e)}})}},{key:"render",value:function(){var e=ae(this.props.versions).reverse();return r.a.createElement("div",null,r.a.createElement("h3",null,"Version History"),r.a.createElement("div",null,r.a.createElement(oe.a,{size:"small",rowKey:"timeStamp",pagination:{pageSize:5},columns:this.getCols(),dataSource:e})))}}]),t}(n.Component),He=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={dummyVar:void 0,updatedVersions:void 0,buildLogRecreationId:""},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onUploadSuccess",value:function(){K.a.info("Build has started"),this.setState({buildLogRecreationId:""+(new Date).getTime()}),Le()}},{key:"onAppBuildFinished",value:function(){var e=this;e.apiManager.getAllApps().then(function(t){for(var a=t.appDefinitions,n=0;n<a.length;n++){var r=a[n];if(r.appName===e.props.apiData.appDefinition.appName)return ae(r)}throw new Error("App not found!")}).then(function(t){e.setState({updatedVersions:{deployedVersion:t.deployedVersion,versions:t.versions}})})}},{key:"onVersionRollbackRequested",value:function(e){var t=this;t.apiManager.uploadCaptainDefinitionContent(t.props.apiData.appDefinition.appName,{schemaVersion:2,dockerfileLines:["FROM "+e.deployedImageName]},e.gitHash||"",!0).then(function(){t.onUploadSuccess()}).catch(q.createCatcher())}},{key:"render",value:function(){var e=this,t=this,a=this.props.apiData.appDefinition,n=a.appPushWebhook&&a.appPushWebhook.pushWebhookToken,i=a.appPushWebhook?a.appPushWebhook.repoInfo:{user:"",password:"",branch:"",repo:""};return r.a.createElement("div",null,r.a.createElement(Re,{onAppBuildFinished:function(){return t.onAppBuildFinished()},appName:a.appName,buildLogRecreationId:t.state.buildLogRecreationId,key:a.appName+"-"+t.state.buildLogRecreationId}),r.a.createElement("div",{style:{height:20}}),r.a.createElement("hr",null),r.a.createElement("div",{style:{height:20}}),r.a.createElement(Fe,{onVersionRollbackRequested:function(e){return t.onVersionRollbackRequested(e)},versions:t.state.updatedVersions?t.state.updatedVersions.versions:a.versions,deployedVersion:t.state.updatedVersions?t.state.updatedVersions.deployedVersion:a.deployedVersion}),r.a.createElement("div",{style:{height:20}}),r.a.createElement("h4",null,r.a.createElement(O.a,{type:"rocket"})," Method 1: Official CLI"),r.a.createElement("p",null,"Use CLI deploy command. This is the easiest method as it only requires a simply command like ",r.a.createElement("code",null,"captainduckduck deploy"),". Read more about it in the"," ",r.a.createElement("a",{href:"https://captainduckduck.com/docs/get-started.html#step-4-deploy-the-test-app",target:"_blank"},"docs")),r.a.createElement("div",{style:{height:20}}),r.a.createElement("h4",null,r.a.createElement(O.a,{type:"rocket"})," Method 2: Tarball"),r.a.createElement("p",null,"You can simply create a tarball (",r.a.createElement("code",null,".tar"),") of your project and upload it here via upload button."),r.a.createElement(Pe,{onUploadSucceeded:function(){return t.onUploadSuccess()},appName:a.appName}),r.a.createElement("div",{style:{height:40}}),r.a.createElement("h4",null,r.a.createElement(O.a,{type:"rocket"})," Method 3: Deploy from Github/Bitbucket/Gitlab"),r.a.createElement("p",null,"Enter your repository information in the form and save. Then copy the URL in the box as a webhook on Github, Bitbucket, Gitlab and etc. Once you push a commit, CaptainDuckDuck starts a new build.",r.a.createElement("br",null)),r.a.createElement(D.a,null,r.a.createElement(W.a,{onFocus:function(e){n&&(e.target.select(),document.execCommand("copy"),K.a.info("Copied to clipboard!"))},className:"code-input",readOnly:!0,disabled:!n,defaultValue:n?window.location.protocol+"//captain."+this.props.apiData.rootDomain+"/api/v1/user/webhooks/triggerbuild?namespace=captain&token="+a.appPushWebhook.pushWebhookToken:"** Add repo info and save for this webhook to appear **"})),r.a.createElement("br",null),r.a.createElement(Ie,{gitRepoValues:i,updateRepoInfo:function(t){console.log(t);var a=ae(e.props.apiData);a.appDefinition.appPushWebhook?a.appDefinition.appPushWebhook.repoInfo=ae(t):a.appDefinition.appPushWebhook={repoInfo:ae(t)},e.props.updateApiData(a)}}),r.a.createElement(D.a,{type:"flex",justify:"end"},r.a.createElement(H.a,{disabled:!i.repo,type:"primary",onClick:function(){return t.props.onUpdateConfigAndSave()}},"Save & Update")),r.a.createElement("div",{style:{height:20}}),r.a.createElement("h4",null,r.a.createElement(O.a,{type:"rocket"})," Method 4: Deploy plain Dockerfile"),r.a.createElement(Ve,{appName:a.appName,onUploadSucceeded:function(){return t.onUploadSuccess()}}),r.a.createElement("div",{style:{height:20}}),r.a.createElement("h4",null,r.a.createElement(O.a,{type:"rocket"})," Method 5: Deploy captain-definition file"),r.a.createElement(Me,{appName:a.appName,onUploadSucceeded:function(){return t.onUploadSuccess()}}))}}]),t}(_),Ge=Se.a.TabPane,We="WEB_SETTINGS",_e=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).reRenderTriggered=!1,a.confirmedAppNameToDelete="",a.state={activeTabKey:We,isLoading:!0,renderCounterForAffixBug:0,apiData:void 0},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"goBackToApps",value:function(){this.props.history.push("/apps")}},{key:"onDeleteAppClicked",value:function(){var e=this,t=ae(e.state.apiData.appDefinition);e.confirmedAppNameToDelete="",G.a.confirm({title:"Confirm Permanent Delete?",content:r.a.createElement("div",null,r.a.createElement("p",null,"You are about to delete ",r.a.createElement("code",null,t.appName),". Enter the name of this app in the box below to confirm deletion of this app. Please note that this is",r.a.createElement("b",null," not reversible"),"."),r.a.createElement("p",{className:t.hasPersistentData?"":"hide-on-demand"},r.a.createElement("b",null,"IMPORTANT:"),r.a.createElement("i",null," ",t.appName)," is an app with persistent data. After deleting the app from CaptainDuckDuck, you will have to manually SSH to your server, and delete Persistent Directories on your server. Refer to the",r.a.createElement("a",{href:"https://captainduckduck.com/docs/app-configuration.html#removing-persistent-apps",target:"_blank",rel:"noopener noreferrer"},"documentations"),"for more details."),r.a.createElement("p",null,"Confirm App Name:"),r.a.createElement(W.a,{type:"text",placeholder:t.appName,onChange:function(t){e.confirmedAppNameToDelete=t.target.value.trim()}})),onOk:function(){e.confirmedAppNameToDelete===t.appName?(e.setState({isLoading:!0}),e.apiManager.deleteApp(t.appName).then(function(){K.a.success("App deleted!")}).then(function(){e.goBackToApps()}).catch(q.createCatcher())):K.a.warning("App name did not match. Operation cancelled.")},onCancel:function(){}})}},{key:"onUpdateConfigAndSave",value:function(){var e=this,t=ae(e.state.apiData.appDefinition);e.setState({isLoading:!0}),this.apiManager.updateConfigAndSave(t.appName,t).then(function(t){e.reFetchData()}).catch(q.createCatcher())}},{key:"render",value:function(){var e=this,t=this;if(t.state.isLoading)return r.a.createElement(z,null);t.reRenderTriggered||(t.reRenderTriggered=!0,setTimeout(function(){t.setState({renderCounterForAffixBug:1})},50));var a=t.state.apiData.appDefinition;return r.a.createElement(D.a,null,r.a.createElement(C.a,{span:20,offset:2},r.a.createElement(U.a,{extra:r.a.createElement(B,{onLinkClicked:function(){return t.goBackToApps()}},r.a.createElement(F.a,{title:"Close"},r.a.createElement(O.a,{type:"close"}))),title:r.a.createElement("span",null,r.a.createElement(O.a,{type:"code"}),"\xa0\xa0\xa0",a.appName)},r.a.createElement(Se.a,{defaultActiveKey:We,onChange:function(e){t.setState({activeTabKey:e})}},r.a.createElement(Ge,{tab:r.a.createElement("span",{className:"unselectable-span"},"HTTP Settings"),key:We},r.a.createElement(we,{setLoading:function(t){return e.setState({isLoading:t})},reFetchData:function(){return e.reFetchData()},apiData:this.state.apiData,apiManager:this.apiManager,updateApiData:function(t){return e.setState({apiData:t})}})),r.a.createElement(Ge,{tab:r.a.createElement("span",{className:"unselectable-span"},"App Configs"),key:"APP_CONFIGS"},r.a.createElement(Ae,{setLoading:function(t){return e.setState({isLoading:t})},reFetchData:function(){return e.reFetchData()},apiData:this.state.apiData,apiManager:this.apiManager,updateApiData:function(t){return e.setState({apiData:t})}})),r.a.createElement(Ge,{tab:r.a.createElement("span",{className:"unselectable-span"},"Deployment"),key:"DEPLOYMENT"},r.a.createElement(He,{setLoading:function(t){return e.setState({isLoading:t})},reFetchData:function(){return e.reFetchData()},apiData:this.state.apiData,apiManager:this.apiManager,onUpdateConfigAndSave:function(){return t.onUpdateConfigAndSave()},updateApiData:function(t){return e.setState({apiData:t})}}))),r.a.createElement("div",{style:{height:70}}),r.a.createElement(Oe.a,{offsetBottom:10,target:function(){var e=t.props.mainContainer;return e&&e.current?e.current:window}},r.a.createElement("div",{className:"DEPLOYMENT"===t.state.activeTabKey?"hide-on-demand":"",style:{borderRadius:8,background:"rgba(51,73,90,0.9)",paddingTop:20,paddingBottom:20}},r.a.createElement(D.a,{type:"flex",justify:"center",gutter:20},r.a.createElement(C.a,{span:8},r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement(H.a,{style:{minWidth:135},type:"danger",size:"large",onClick:function(){return t.onDeleteAppClicked()}},"Delete App"))),r.a.createElement(C.a,{span:8},r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement(H.a,{style:{minWidth:135},type:"primary",size:"large",onClick:function(){return t.onUpdateConfigAndSave()}},"Save & Update")))))))))}},{key:"componentDidMount",value:function(){this.reFetchData()}},{key:"reFetchData",value:function(){var e=this;e.setState({isLoading:!0}),this.apiManager.getAllApps().then(function(t){for(var a=0;a<t.appDefinitions.length;a++){var n=t.appDefinitions[a];if(n.appName===e.props.match.params.appName)return void e.setState({isLoading:!1,apiData:{appDefinition:n,rootDomain:t.rootDomain,defaultNginxConfig:t.defaultNginxConfig}})}e.goBackToApps()}).catch(q.createCatcher())}}]),t}(_),Ye=(a(520),a(236)),ze=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:{height:240,overflow:"hidden",borderRadius:5,border:"1px solid #dddddd",backgroundColor:"#fbfbfb"}},r.a.createElement("div",{style:{textAlign:"center",margin:16}},r.a.createElement(Ye.a,{style:{backgroundColor:this.props.color},size:64,icon:this.props.icon})),r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement("h4",null,this.props.titleText,r.a.createElement("br",null),this.props.titleNumber),r.a.createElement("p",null,this.props.text1,r.a.createElement("br",null),this.props.text2)))}}]),t}(n.Component),Ke=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={apiData:void 0},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"updateApi",value:function(){var e=this;this.apiManager.getLoadBalancerInfo().then(function(t){e.setState({apiData:t})}).catch(q.createCatcher())}},{key:"componentWillUnmount",value:function(){this.updateApiInterval&&clearInterval(this.updateApiInterval)}},{key:"componentDidMount",value:function(){var e=this;this.updateApi(),this.updateApiInterval=setInterval(function(){e.updateApi()},2e4)}},{key:"render",value:function(){return this.state.apiData?r.a.createElement("div",null,r.a.createElement(D.a,null,r.a.createElement(C.a,{span:22,offset:1},r.a.createElement(U.a,{title:"Load Balancer Stats"},r.a.createElement(D.a,{type:"flex",gutter:10},r.a.createElement(C.a,{span:6},r.a.createElement(F.a,{title:"Constantly going up as refreshing the values"},r.a.createElement("div",null,r.a.createElement(ze,{icon:"global",color:"#2361ae",titleText:"Total Requests",titleNumber:"".concat(this.state.apiData.total),text1:"",text2:""})))),r.a.createElement(C.a,{span:6},r.a.createElement(ze,{icon:"cluster",color:"#23ae89",titleText:"Active Connections",titleNumber:"".concat(this.state.apiData.activeConnections),text1:"".concat(this.state.apiData.handled," handled"),text2:"".concat(this.state.apiData.accepted," accepted")})),r.a.createElement(C.a,{span:6},r.a.createElement(ze,{icon:"sync",color:"#d3a938",titleText:"Active Requests",titleNumber:"".concat(this.state.apiData.reading+this.state.apiData.writing),text1:"".concat(this.state.apiData.reading," reading"),text2:"".concat(this.state.apiData.writing," writing")})),r.a.createElement(C.a,{span:6},r.a.createElement(ze,{icon:"clock-circle",color:"#ae2323",titleText:"Waiting Requests",titleNumber:"".concat(this.state.apiData.waiting),text1:"  ",text2:"  "}))))))):r.a.createElement(z,null)}}]),t}(_),qe=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement("a",{href:"https://github.com/netdata/netdata/",target:"_blank",rel:"noopener noreferrer"},"NetData")," ","is one of the most popular and most powerful monitoring tools that provide a web interface. It is a system for distributed real-time performance and health monitoring. It provides unparalleled insights, in real-time, of everything happening on the system it runs (including applications such as web and database servers), using modern interactive web dashboards."),r.a.createElement("p",null,"NetData is fast and efficient, designed to permanently run on all systems (physical & virtual servers, containers, IoT devices), without disrupting their core function."),r.a.createElement("p",null,"Captain provides a simple interface to enable NetData on your captain instance. Currently, Captain only supports installing NetData on your"," ",r.a.createElement("b",null,"leader node"),", i.e., the node where Captain instance resides. This limitation is due to a limitation in Docker interface,",r.a.createElement("a",{href:"https://github.com/moby/moby/issues/25885/",target:"_blank",rel:"noopener noreferrer"}," ","see here")," ","."),r.a.createElement("p",null,r.a.createElement("i",null,"For more details regarding NetData, visit their "),r.a.createElement("a",{href:"https://github.com/firehol/netdata/",target:"_blank",rel:"noopener noreferrer"},"GitHub page"),"."))}}]),t}(n.Component),Je=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"changeModel",value:function(e,t,a){var n=ae(this.props.netDataInfo),r=n.data;r[e]||(r[e]={}),r[e][t]=a,this.props.updateModel(n)}},{key:"render",value:function(){var e=this,t=this.props.netDataInfo;return r.a.createElement("div",null,r.a.createElement("h3",null,"Notification Settings"),r.a.createElement("p",null,"NetData offers multiple ways for you to receive notifications if something is going wrong with your server resource usage.",r.a.createElement("i",null,"All notification options are completely OPTIONAL.")),r.a.createElement("hr",null),r.a.createElement("br",null),r.a.createElement("h4",null,"Email (SMTP)"),r.a.createElement(D.a,null,r.a.createElement(C.a,{span:20,offset:2},r.a.createElement(D.a,{type:"flex",gutter:20,align:"middle"},r.a.createElement(C.a,{className:"netdata-field",span:12},"Recipient Email",r.a.createElement(W.a,{type:"text",placeholder:"alerts.receiver@example.com",value:t.data.smtp.to,onChange:function(t){return e.changeModel("smtp","to",t.target.value)}})),r.a.createElement(C.a,{className:"netdata-field",span:12},"Server Tag",r.a.createElement(W.a,{type:"text",placeholder:"my-aws-server-01-anything",value:t.data.smtp.hostname,onChange:function(t){return e.changeModel("smtp","hostname",t.target.value)}})),r.a.createElement(C.a,{className:"netdata-field",span:12},"SMTP Server",r.a.createElement(W.a,{type:"text",placeholder:"smtp.gmail.com",value:t.data.smtp.server,onChange:function(t){return e.changeModel("smtp","server",t.target.value)}})),r.a.createElement(C.a,{className:"netdata-field",span:6},"SMTP Port",r.a.createElement(W.a,{type:"number",placeholder:"587",value:t.data.smtp.port,onChange:function(t){return e.changeModel("smtp","port",t.target.value)}})),r.a.createElement(C.a,{className:"netdata-field",span:6},"Unsecure",r.a.createElement(ve.a,{checked:!!t.data.smtp.allowNonTls,onChange:function(t){return e.changeModel("smtp","allowNonTls",t.target.checked)}},"allow non-TLS")),r.a.createElement(C.a,{className:"netdata-field",span:12},"SMTP Username",r.a.createElement(W.a,{type:"text",placeholder:"alerts.receiver@example.com",value:t.data.smtp.username,onChange:function(t){return e.changeModel("smtp","username",t.target.value)}})),r.a.createElement(C.a,{className:"netdata-field",span:12},"SMTP password",r.a.createElement(W.a,{type:"text",placeholder:"your password",value:t.data.smtp.password,onChange:function(t){return e.changeModel("smtp","password",t.target.value)}}))))),r.a.createElement("br",null),r.a.createElement("h4",null,"Slack"),r.a.createElement(D.a,null,r.a.createElement(C.a,{span:20,offset:2},r.a.createElement(D.a,{type:"flex",gutter:20,align:"middle"},r.a.createElement(C.a,{className:"netdata-field",span:12},"Slack Webhook",r.a.createElement(W.a,{type:"text",placeholder:"https://hooks.slack.com/services/XXXX",value:t.data.slack.hook,onChange:function(t){return e.changeModel("slack","hook",t.target.value)}})),r.a.createElement(C.a,{className:"netdata-field",span:12},"Slack Channel",r.a.createElement(W.a,{type:"text",placeholder:"alertschannel",value:t.data.slack.channel,onChange:function(t){return e.changeModel("slack","channel",t.target.value)}}))))),r.a.createElement("br",null),r.a.createElement("h4",null,"Telegram"),r.a.createElement(D.a,null,r.a.createElement(C.a,{span:20,offset:2},r.a.createElement(D.a,{type:"flex",gutter:20,align:"middle"},r.a.createElement(C.a,{className:"netdata-field",span:12},"Bot Token",r.a.createElement(W.a,{type:"text",placeholder:"TELEGRAM_BOT_TOKEN",value:t.data.telegram.botToken,onChange:function(t){return e.changeModel("telegram","botToken",t.target.value)}})),r.a.createElement(C.a,{className:"netdata-field",span:12},"Chat ID",r.a.createElement(W.a,{type:"text",placeholder:"Telegram Chat ID",value:t.data.telegram.chatId,onChange:function(t){return e.changeModel("telegram","chatId",t.target.value)}}))))),r.a.createElement("br",null),r.a.createElement("h4",null,"Push Bullet"),r.a.createElement(D.a,null,r.a.createElement(C.a,{span:20,offset:2},r.a.createElement(D.a,{type:"flex",gutter:20,align:"middle"},r.a.createElement(C.a,{className:"netdata-field",span:12},"Push Bullet API token",r.a.createElement(W.a,{type:"text",placeholder:"PUSH_BULLET_API_TOKEN",value:t.data.pushBullet.apiToken,onChange:function(t){return e.changeModel("pushBullet","apiToken",t.target.value)}})),r.a.createElement(C.a,{className:"netdata-field",span:12},"Default Email (fallback receiver)",r.a.createElement(W.a,{type:"text",placeholder:"alerts.receiver@example.com",value:t.data.pushBullet.fallbackEmail,onChange:function(t){return e.changeModel("pushBullet","fallbackEmail",t.target.value)}}))))))}}]),t}(n.Component),Ze=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={apiData:void 0},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.refetchData()}},{key:"refetchData",value:function(){var e=this;e.setState({apiData:void 0}),this.apiManager.getNetDataInfo().then(function(t){e.setState({apiData:t})}).catch(q.createCatcher())}},{key:"toggleNetDataClicked",value:function(e){var t=ae(this.state.apiData);t.isEnabled=!!e,this.onUpdateNetDataClicked(t)}},{key:"onUpdateNetDataClicked",value:function(e){var t=this;return t.setState({apiData:void 0}),this.apiManager.updateNetDataInfo(e).then(function(){K.a.success(e.isEnabled?"NetData is started and updated!":"NetData has stopped!")}).catch(q.createCatcher()).then(function(){t.refetchData()})}},{key:"render",value:function(){var e=this;if(!this.state.apiData)return r.a.createElement(z,null);var t=this.state.apiData;return r.a.createElement("div",null,r.a.createElement(D.a,null,r.a.createElement(C.a,{span:18,offset:3},r.a.createElement(U.a,{title:"NetData Monitoring Tool"},r.a.createElement(qe,null),r.a.createElement("hr",null),r.a.createElement("div",{style:{height:30}}),r.a.createElement("div",{className:t.isEnabled?"hide-on-demand":""},r.a.createElement(D.a,{type:"flex",justify:"end"},r.a.createElement(H.a,{onClick:function(){return e.toggleNetDataClicked(!0)},type:"primary"},r.a.createElement("span",null,"Start NetData Engine \xa0",r.a.createElement(O.a,{type:"poweroff"}))))),r.a.createElement("div",{className:t.isEnabled?"":"hide-on-demand"},r.a.createElement(D.a,{type:"flex",justify:"end"},r.a.createElement(H.a,{style:{marginRight:50},onClick:function(){return e.toggleNetDataClicked(!1)},type:"danger"},r.a.createElement("span",null,"Turn NetData Off \xa0",r.a.createElement(O.a,{type:"poweroff"}))),r.a.createElement("a",{type:"submit",href:"//"+t.netDataUrl,target:"_blank",rel:"noopener noreferrer"},r.a.createElement(H.a,{type:"primary"},r.a.createElement("span",null,"Open NetData \xa0",r.a.createElement(O.a,{type:"area-chart"}))))),r.a.createElement("div",{style:{height:30}}),r.a.createElement("hr",null),r.a.createElement("div",{style:{height:30}}),r.a.createElement(Je,{updateModel:function(t){e.setState({apiData:t})},netDataInfo:t}),r.a.createElement("br",null),r.a.createElement(D.a,{type:"flex",justify:"end"},r.a.createElement(H.a,{type:"primary",onClick:function(){return e.onUpdateNetDataClicked(ae(e.state.apiData))}},"Update NetData")))))))}}]),t}(_),Xe=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(Ke,null),r.a.createElement("div",{style:{height:50}}),r.a.createElement(Ze,null))}}]),t}(n.Component),Qe=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={isLoading:!1,old:"",new1:"",new2:""},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onChangePasswordClicked",value:function(){var e=this;this.state.new1?this.state.new1===this.state.new2?(this.setState({isLoading:!0}),this.apiManager.changePass(this.state.old,this.state.new1).catch(q.createCatcher()).then(function(t){e.setState({isLoading:!1})})):K.a.error("New passwords confirm does not match"):K.a.error("New password cannot be empty")}},{key:"render",value:function(){var e=this;return this.state.isLoading?r.a.createElement(z,null):r.a.createElement("div",null,"Old Password",r.a.createElement(W.a,{type:"password",onChange:function(t){return e.setState({old:t.target.value})}}),r.a.createElement("div",{style:{height:20}}),r.a.createElement("hr",null),r.a.createElement("div",{style:{height:20}}),"New Password",r.a.createElement(W.a,{type:"password",onChange:function(t){return e.setState({new1:t.target.value})}}),r.a.createElement("div",{style:{height:20}}),"Confirm New Password",r.a.createElement(W.a,{type:"password",onChange:function(t){return e.setState({new2:t.target.value})}}),r.a.createElement("div",{style:{height:40}}),r.a.createElement(D.a,{type:"flex",justify:"end"},r.a.createElement(H.a,{onClick:function(){return e.onChangePasswordClicked()},type:"primary"},"Change Password")))}}]),t}(_),$e=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).hasAlreadyActivated=!1,a.state={timeToRefresh:0},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"startTimer",value:function(){var e=this;e.setState({timeToRefresh:30}),setInterval(function(){e.state.timeToRefresh<2?window.location.reload(!0):e.setState({timeToRefresh:e.state.timeToRefresh-1})},1e3)}},{key:"render",value:function(){var e=this;return e.props.isRefreshTimerActivated&&!this.hasAlreadyActivated&&(this.hasAlreadyActivated=!0,setTimeout(function(){return e.startTimer()},10)),r.a.createElement("div",null,r.a.createElement(G.a,{closable:!1,footer:r.a.createElement("div",null),title:"Update Process Started",visible:e.state.timeToRefresh>0},r.a.createElement("div",null,e.props.children,r.a.createElement("p",null,r.a.createElement("b",null,"Time to Refresh: "),this.state.timeToRefresh))))}}]),t}(n.Component),et=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={versionInfo:void 0,isRefreshTimerActivated:!1},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;e.apiManager.getVersionInfo().then(function(t){e.setState({versionInfo:t})}).catch(q.createCatcher())}},{key:"onPerformUpdateClicked",value:function(){var e=this,t=this.state.versionInfo;e.apiManager.performUpdate(t.latestVersion).then(function(t){e.setState({isRefreshTimerActivated:!0})}).catch(q.createCatcher())}},{key:"render",value:function(){var e=this,t=this.state.versionInfo;return t?r.a.createElement("div",null,r.a.createElement("p",null,"Captain allows in-place updates to be installed. However, always read the change logs before updating your Captain. There might be breaking changes that you need to be aware of. The update usually takes around 60 seconds and your Captain may become unresponsive until the update process is finished. Your apps will stay functional and responsive during this time, except for a very short period of 10 seconds or less."),r.a.createElement("br",null),r.a.createElement("p",null,r.a.createElement("b",null,"Current Version"),": ",t.currentVersion),r.a.createElement("p",null,r.a.createElement("b",null,"Latest Stable Version"),": ",t.latestVersion),r.a.createElement("div",{className:t.canUpdate?"":"hide-on-demand"},r.a.createElement(D.a,{type:"flex",justify:"end"},r.a.createElement(H.a,{type:"primary",onClick:function(){return e.onPerformUpdateClicked()}},r.a.createElement("span",null,r.a.createElement(O.a,{type:"cloud-download"}))," ","\xa0 Install Update"))),r.a.createElement("div",{className:t.canUpdate?"hide-on-demand":""},r.a.createElement(Q.a,{message:"Your Captain is the latest version.",type:"info"})),r.a.createElement($e,{isRefreshTimerActivated:this.state.isRefreshTimerActivated},r.a.createElement("div",null,r.a.createElement("p",null,"Update takes around 30 to 60 seconds to complete depending on your server connection speed."),r.a.createElement("p",null,"Your Captain dashboard is not functional during the update. Please wait until this page is refreshed automatically."),r.a.createElement("br",null),r.a.createElement("br",null)))):r.a.createElement(z,null)}}]),t}(_),tt=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={nginxConfig:void 0,isRefreshTimerActivated:!1},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.apiManager.getNginxConfig().then(function(t){e.setState({nginxConfig:t})}).catch(q.createCatcher())}},{key:"onLoadDefaultNginxConfigClicked",value:function(){var e=ae(this.state.nginxConfig);e.baseConfig.customValue=e.baseConfig.byDefault,e.captainConfig.customValue=e.captainConfig.byDefault,this.setState({nginxConfig:e})}},{key:"onUpdateNginxConfigClicked",value:function(){var e=this,t=ae(this.state.nginxConfig);this.apiManager.setNginxConfig(t.baseConfig.customValue,t.captainConfig.customValue).then(function(){e.setState({isRefreshTimerActivated:!0})}).catch(q.createCatcher())}},{key:"render",value:function(){var e=this,t=this.state.nginxConfig;return t?r.a.createElement("div",null,r.a.createElement($e,{isRefreshTimerActivated:e.state.isRefreshTimerActivated},r.a.createElement("div",null,"Nginx is successfully updated, Captain will restart in 30 seconds."," ",r.a.createElement("b",null,"Please wait until the page is automatically refreshed."),r.a.createElement("br",null),r.a.createElement("br",null)))," ",r.a.createElement("p",null,"Captain allows you to set custom configurations for your nginx router. This will allow high customization level in terms of caching, special routing, http2 and etc."),r.a.createElement("p",null,"Note that templates are build using EJS template pattern. Do not change the areas between ",r.a.createElement("code",null,"<%")," and ",r.a.createElement("code",null,"%>")," ","unless you really know what you're doing!"),r.a.createElement("br",null),r.a.createElement("p",null,r.a.createElement("b",null,"Base Config Location in nginx container"),": /etc/nginx/nginx.conf"),r.a.createElement("div",{className:t.baseConfig.customValue||t.captainConfig.customValue?"":"hide-on-demand"},r.a.createElement(W.a.TextArea,{className:"code-input",placeholder:"",rows:17,value:t.baseConfig.customValue,onChange:function(a){var n=ae(t);n.baseConfig.customValue=a.target.value,e.setState({nginxConfig:n})}}),r.a.createElement("div",{style:{height:40}})),r.a.createElement("p",null,r.a.createElement("b",null,"Captain Config Location in nginx container"),": /etc/nginx/conf.d/captain-root.conf"),r.a.createElement("div",{className:t.baseConfig.customValue||t.captainConfig.customValue?"":"hide-on-demand"},r.a.createElement(W.a.TextArea,{className:"code-input",placeholder:"",rows:17,value:t.captainConfig.customValue,onChange:function(a){var n=ae(t);n.captainConfig.customValue=a.target.value,e.setState({nginxConfig:n})}})),r.a.createElement("div",{style:{height:40}}),r.a.createElement("div",null,r.a.createElement(D.a,{type:"flex",justify:"end"},r.a.createElement(H.a,{type:"default",onClick:function(){return e.onLoadDefaultNginxConfigClicked()}},"Load Default and Edit")),r.a.createElement("div",{style:{height:20}}),r.a.createElement(D.a,{type:"flex",justify:"end"},r.a.createElement(H.a,{type:"primary",onClick:function(){return e.onUpdateNginxConfigClicked()}},r.a.createElement("span",null,r.a.createElement(O.a,{type:"sync"}))," ","\xa0 Save and Update")))):r.a.createElement(z,null)}}]),t}(_),at=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getCols",value:function(){return[{title:"Image ID",dataIndex:"imageId",render:function(e){return e=e||"",r.a.createElement("div",{style:{width:150,fontSize:"90%"}},e.substr(0,Math.min(e.length,25)),"...")}},{title:"Associated Tags",dataIndex:"imageName",render:function(e){return e=e||"",r.a.createElement("div",{style:{whiteSpace:"pre-line",fontSize:"90%"}},e)}}]}},{key:"getData",value:function(){for(var e=[],t=0;t<this.props.unusedImages.length;t++){var a=this.props.unusedImages[t];e.push({key:a.id,imageId:a.id,imageName:a.tags.join("\n")})}return e}},{key:"getRowSelection",value:function(){var e=this;return{onChange:function(t,a){e.props.updateModel(t)},getCheckboxProps:function(e){return{disabled:!1,name:e.imageId}}}}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(oe.a,{pagination:!1,rowSelection:this.getRowSelection(),columns:this.getCols(),dataSource:this.getData()}))}}]),t}(n.Component),nt=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={mostRecentLimit:2,selectedImagesForDelete:[],unusedImages:[]},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onRemoveImagesClicked",value:function(){var e=this;this.setState({unusedImages:void 0}),this.apiManager.deleteImages(this.state.selectedImagesForDelete).then(function(t){K.a.success("Unused images are deleted."),e.onGetOldImagesClicked()}).catch(q.createCatcher())}},{key:"onGetOldImagesClicked",value:function(){var e=this;this.setState({unusedImages:void 0}),this.apiManager.getUnusedImages(this.state.mostRecentLimit).then(function(t){e.setState({unusedImages:t.unusedImages})}).catch(q.createCatcher())}},{key:"render",value:function(){var e=this,t=this,a=this.state.unusedImages;if(!a)return r.a.createElement(z,null);var n=!(!t.state.selectedImagesForDelete||!t.state.selectedImagesForDelete.length);return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("p",null,"Every time you deploy a new build, Docker builds a new image for you. Typically, a large part of this image is shared between the old version and the new version, but a small chunk is added to your disk with each build. You can read more about disk cleanup in the docs, but as a simple interface, this widget gives you the ability to perform image cleanups on demand."),r.a.createElement("p",null,"You can perform this action, after each deploy. But it's typically not needed with that frequency. For typical mid-sized projects, it's recommended to perform this cleanup after every ~20 builds."),r.a.createElement("p",null,"With default parameter, it keeps the last two recent builds of all current apps, and creates a list of images that can be deleted (by clicking on Get List button). You can select which images you want to delete and click on Remove Images button. You might noticed that some images are not deleted even though you clicked on Remove Images, it means they are being directly or indirectly in-use by Docker. A common example For indirect usage is an image whose child image is being used by an alive container."),r.a.createElement("br",null)),r.a.createElement(D.a,null,r.a.createElement(C.a,{span:12},r.a.createElement(F.a,{title:"For example, enter 2 in order to exclude 2 most recent builds during clean-up"},r.a.createElement(W.a,{addonBefore:"Keep most recent",type:"number",value:this.state.mostRecentLimit+"",onChange:function(t){e.setState({mostRecentLimit:Number(t.target.value)})}}))),r.a.createElement(C.a,{span:12},r.a.createElement(D.a,{type:"flex",justify:"end"},r.a.createElement(H.a,{type:"default",onClick:function(){return e.onGetOldImagesClicked()}},r.a.createElement("span",null,r.a.createElement(O.a,{type:"sync"}))," ","\xa0 Get List")))),r.a.createElement("div",{className:a.length>0?"":"hide-on-demand"},r.a.createElement("div",{style:{height:20}}),r.a.createElement(D.a,{type:"flex",justify:"end"},r.a.createElement(F.a,{title:n?"":"Select images that you want to remove. You can select all from the top row."},r.a.createElement(H.a,{disabled:!n,type:"primary",onClick:function(){t.onRemoveImagesClicked()}},r.a.createElement("span",null,r.a.createElement(O.a,{type:"delete"})," ")," ","\xa0 Remove Unused Images"))),r.a.createElement("div",{style:{height:20}}),r.a.createElement("div",null,r.a.createElement("b",null,"NOTE: ")," Images that are being used (directly or indirectly) will not be deleted even if you select them."),r.a.createElement("div",{style:{height:20}}),r.a.createElement(at,{unusedImages:a,updateModel:function(t){return e.setState({selectedImagesForDelete:t})}})))}}]),t}(_),rt=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(D.a,{type:"flex",justify:"space-around"},r.a.createElement(C.a,{span:8},r.a.createElement("div",{style:{margin:10}},r.a.createElement(U.a,{title:"Check for Updates"},r.a.createElement(et,null)))),r.a.createElement(C.a,{span:16},r.a.createElement("div",{style:{margin:10}},r.a.createElement(U.a,{title:"NGINX Configurations"},r.a.createElement(tt,null)))),r.a.createElement(C.a,{span:8},r.a.createElement("div",{style:{margin:10}},r.a.createElement(U.a,{title:"Change Password"},r.a.createElement(Qe,null)))),r.a.createElement(C.a,{span:16},r.a.createElement("div",{style:{margin:10}},r.a.createElement(U.a,{title:"Disk Cleanup"},r.a.createElement(nt,null))))))}}]),t}(n.Component),it=function(){function e(){Object(l.a)(this,e)}return Object(s.a)(e,[{key:"getOneClickAppByName",value:function(e){return this.getAllOneClickApps().then(function(t){if(!e)throw new Error("appName is empty!");var a=t.filter(function(t){return t.name===e})[0].download_url;return A.a.get(a).then(function(e){return e.data})})}},{key:"getAllOneClickApps",value:function(){return A.a.get("https://api.github.com/repos/githubsaturn/testing-v1-one-click-apps/contents/one-click-apps/v1").then(function(e){return e.data.map(function(e){return{name:e.name.substr(0,e.name.length-".JSON".length),download_url:e.download_url}})})}}]),e}(),ot=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={oneClickAppList:void 0,selectedApp:void 0},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;(new it).getAllOneClickApps().then(function(t){e.setState({oneClickAppList:t})}).catch(q.createCatcher())}},{key:"createOptions",value:function(){return this.state.oneClickAppList.map(function(e){return r.a.createElement(te.a.Option,{key:e.name,value:e.name},e.name)})}},{key:"render",value:function(){var e=this;return this.state.oneClickAppList?r.a.createElement("div",null,r.a.createElement(D.a,{type:"flex",justify:"center"},r.a.createElement(C.a,{span:16},r.a.createElement(U.a,{title:"One Click Apps"},r.a.createElement("p",null,"Choose an app, a database or a bundle (app+database) from the list below. The rest is magic, well... Wizard! One click apps will be retrieved from this GitHub Repo:"," ",r.a.createElement("a",{href:"https://github.com/githubsaturn/testing-v1-one-click-apps",target:"_blank",rel:"noopener noreferrer"},"testing-v1-one-click-apps")),r.a.createElement("div",{style:{height:50}}),r.a.createElement(D.a,{type:"flex",justify:"end",align:"middle"},r.a.createElement("b",null,"One-Click Apps List: \xa0\xa0"),r.a.createElement(te.a,{style:{minWidth:150},onChange:function(t){e.setState({selectedApp:t.toString()})}},e.createOptions())),r.a.createElement("div",{style:{height:60}}),r.a.createElement(D.a,{type:"flex",justify:"end",align:"middle"},r.a.createElement(H.a,{onClick:function(){return e.props.history.push("/apps/oneclick/".concat(e.state.selectedApp))},disabled:!e.state.selectedApp,style:{minWidth:150},type:"primary"},"Next")))))):r.a.createElement(z,null)}}]),t}(n.Component),lt=a(69),st=function(e){function t(e){var a;Object(l.a)(this,t),a=Object(c.a)(this,Object(u.a)(t).call(this,e));var n={};return a.props.oneClickAppVariables.forEach(function(e){var t=e.defaultValue;t&&(n[e.id]=t)}),a.state={enteredVariables:n,blurredFields:{}},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onNextClicked",value:function(){var e=this,t=ae(e.state.blurredFields),a=!0;e.props.oneClickAppVariables.forEach(function(n){t[n.id]=!0,e.isFieldValueValid(n)||(a=!1)}),a?e.props.onNextClicked(e.state.enteredVariables):K.a.error("Fix all errors before deploying."),e.setState({blurredFields:t})}},{key:"isFieldValueValid",value:function(e){var t=this.state.enteredVariables[e.id]||"",a=!0;if(e.validRegex){var n=/\/(.*)\/(.*)/.exec(e.validRegex);n&&new RegExp(n[1],n[2]).test(t)||(a=!1)}return a}},{key:"createTextFields",value:function(){var e=this,t=this;return this.props.oneClickAppVariables.map(function(a){var n=t.state.enteredVariables[a.id];return r.a.createElement("div",{key:a.id,style:{marginBottom:40}},r.a.createElement("h4",null,a.label),r.a.createElement("div",{style:{paddingBottom:5,fontSize:"90%"},className:a.description?"":"hide-on-demand"},a.description),r.a.createElement(D.a,null,r.a.createElement(C.a,{span:12},r.a.createElement(W.a,{type:"text",placeholder:a.defaultValue,value:void 0===n?a.defaultValue:n,onChange:function(t){var n=ae(e.state.enteredVariables);n[a.id]=t.target.value,e.setState({enteredVariables:n})},onBlur:function(e){var n=ae(t.state.blurredFields);n[a.id]=!0,t.setState({blurredFields:n})}}),r.a.createElement("div",{style:{height:5}}),r.a.createElement(Q.a,{className:!t.state.blurredFields[a.id]||t.isFieldValueValid(a)?"hide-on-demand":"",showIcon:!0,message:r.a.createElement("span",null,"Invalid value. Does not match Regex:",r.a.createElement("code",null,a.validRegex)),type:"error"}))))})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",null,this.createTextFields()),r.a.createElement(D.a,{type:"flex",justify:"end"},r.a.createElement(H.a,{size:"large",style:{minWidth:150},type:"primary",onClick:function(){return e.onNextClicked()}},"Deploy")))}}]),t}(n.Component),ct=a(243),ut=function(){function e(){Object(l.a)(this,e),this.apiManager=new V}return Object(s.a)(e,[{key:"createRegisterPromise",value:function(e,t){var a=this;return Promise.resolve().then(function(){return a.apiManager.registerNewApp(e,!!t.volumes&&!!t.volumes.length)})}},{key:"createConfigurationPromise",value:function(e,t){var a=this;return Promise.resolve().then(function(){return a.apiManager.getAllApps().then(function(t){for(var a=t.appDefinitions,n=0;n<a.length;n++){var r=a[n];if(r.appName===e)return ae(r)}}).then(function(n){if(!n)throw new Error("App was not found right after registering!!");n.volumes=n.volumes||[];for(var r=t.volumes||[],i=0;i<r.length;i++){var o=r[i].split(":");o[0].startsWith("/")?n.volumes.push({hostPath:o[0],containerPath:o[1]}):n.volumes.push({volumeName:o[0],containerPath:o[1]})}n.ports=n.ports||[];for(var l=t.ports||[],s=0;s<l.length;s++){var c=l[s].split(":");n.ports.push({hostPort:Number(c[0]),containerPort:Number(c[1])})}n.envVars=n.envVars||[];var u=t.environment||{};return Object.keys(u).forEach(function(e){n.envVars.push({key:e,value:u[e]})}),a.apiManager.updateConfigAndSave(e,n)})})}},{key:"createDeploymentPromise",value:function(e,t){var a=this;return Promise.resolve().then(function(){var n={schemaVersion:2};return t.image?n.imageName=t.image:n.dockerfileLines=t.dockerFileLines,a.apiManager.uploadCaptainDefinitionContent(e,n,"",!1)})}}]),e}(),pt=function(){function e(t){Object(l.a)(this,e),this.onDeploymentStateChanged=t,this.deploymentHelper=new ut}return Object(s.a)(e,[{key:"startDeployProcess",value:function(e,t){for(var a=this,n=JSON.stringify(e),r=0;r<e.variables.length;r++){var i=e.variables[r];n=n.split(i.id).join(t[i.id]||"")}try{this.template=JSON.parse(n)}catch(y){return void this.onDeploymentStateChanged({steps:["Parsing the template"],error:"Cannot parse: ".concat(n)+"\n\n\n\n"+y,currentStep:0})}var o=this.createAppsArrayInOrder();if(o)if(0===o.length)a.onDeploymentStateChanged({steps:["Parsing the template"],error:"Cannot parse the template. No services found!!",currentStep:0});else{for(var l=[],s=0;s<o.length;s++){var c=o[s];l.push.apply(l,Object(ct.a)(a.createDeploymentStepPromises(c.appName,c.service)))}for(var u=["Parsing the template"],p=0;p<l.length;p++)u.push(l[p].stepName);for(var d=0,m=function(){return new Promise(function(e){d++,a.onDeploymentStateChanged(ae({steps:u,error:"",currentStep:d,successMessage:d>=u.length?a.template.instructions.end:void 0})),e()})},h=m(),f=0;f<l.length;f++){var g=l[f];h=h.then(g.stepPromise).then(m)}h.catch(function(e){a.onDeploymentStateChanged(ae({steps:u,error:"Failed: "+e,currentStep:d}))})}else a.onDeploymentStateChanged({steps:["Parsing the template"],error:"Cannot parse the template. Dependency tree cannot be resolved. Infinite loop!!",currentStep:0})}},{key:"createAppsArrayInOrder",value:function(){var e=[],t=0,a=this.template.dockerCompose.services;Object.keys(a).forEach(function(e){t++});for(var n=0;e.length<t;){if(n>t)return;n++,Object.keys(a).forEach(function(t){for(var n=0;n<e.length;n++){if(e[n].appName===t)return}for(var r=a[t],i=r.depends_on||[],o=0;o<i.length;o++){for(var l=i[o],s=!1,c=0;c<e.length;c++)l===e[c].appName&&(s=!0);if(!s)return}e.push({appName:t,service:r})})}return e}},{key:"createDeploymentStepPromises",value:function(e,t){var a=[],n=this;return a.push({stepName:"Registering ".concat(e),stepPromise:function(){return n.deploymentHelper.createRegisterPromise(e,t)}}),a.push({stepName:"Configuring ".concat(e," (volumes, ports, environmental variables)"),stepPromise:function(){return n.deploymentHelper.createConfigurationPromise(e,t)}}),a.push({stepName:"Deploying ".concat(e," (might take up to a minute)"),stepPromise:function(){return n.deploymentHelper.createDeploymentPromise(e,t)}}),a}}]),e}(),dt=(a(523),a(175)),mt=dt.a.Step,ht=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"createSteps",value:function(){for(var e=this.props.deploymentState.steps,t=[],a=0;a<e.length;a++)t.push({text:r.a.createElement("span",null,r.a.createElement("span",null,a!==this.props.deploymentState.currentStep||this.props.deploymentState.error?r.a.createElement("span",null):r.a.createElement(O.a,{style:{fontSize:"16px",paddingRight:12},type:"loading"})),e[a]),icon:void 0});return t.map(function(e){return r.a.createElement(mt,{icon:e.icon,title:e.text})})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(D.a,{type:"flex",justify:"center"},r.a.createElement(C.a,{span:16},r.a.createElement(U.a,{title:"Deploying your ".concat(this.props.appName)},r.a.createElement("p",null,"This process takes a few minutes to complete. DO NOT refresh this page and DO NOT navigate away!!!"),r.a.createElement("div",{style:{padding:20}},r.a.createElement("h3",null,"Progress:"),r.a.createElement("div",{style:{height:20}}),r.a.createElement(dt.a,{status:e.props.deploymentState.error?"error":void 0,direction:"vertical",current:e.props.deploymentState.currentStep},e.createSteps()),r.a.createElement("div",{className:e.props.deploymentState.successMessage?"":"hide-on-demand"},r.a.createElement("div",{style:{height:20}}),r.a.createElement(Q.a,{showIcon:!0,type:"success",message:r.a.createElement("div",{style:{whiteSpace:"pre-line"}},e.props.deploymentState.successMessage)}),r.a.createElement("div",{style:{height:80}}),r.a.createElement(D.a,{type:"flex",justify:"end"},r.a.createElement(H.a,{style:{minWidth:150},size:"large",type:"primary",onClick:function(){return e.props.onFinishClicked()}},"Finish"))),r.a.createElement("div",{className:e.props.deploymentState.error?"":"hide-on-demand"},r.a.createElement("div",{style:{height:20}}),r.a.createElement(Q.a,{showIcon:!0,type:"error",message:e.props.deploymentState.error}),r.a.createElement("div",{style:{height:80}}),r.a.createElement(D.a,{type:"flex",justify:"end"},r.a.createElement(H.a,{size:"large",type:"primary",onClick:function(){return e.props.onRestartClicked()}},"Go Back & Try Again")))))))))}}]),t}(n.Component),ft=function(e){function t(e){var a;Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).isUnmount=!1;var n=Object(lt.a)(Object(lt.a)(a));return a.state={apiData:void 0,deploymentState:void 0},a.oneClickAppDeployHelper=new pt(function(e){n.isUnmount||n.setState({deploymentState:e})}),a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentWillUnmount",value:function(){this.isUnmount=!0}},{key:"componentDidMount",value:function(){var e=this;(new it).getOneClickAppByName(this.props.match.params.appName).then(function(t){"1"===(t.captainVersion||"").toString()?(t.variables=t.variables||[],t.variables.unshift({id:"$$cap_appname",label:"App Name",description:"This is your app name. Pick a name such as my-first-1-click-app",validRegex:"/^([a-z0-9]+\\-)*[a-z0-9]+$/"}),e.setState({apiData:t})):K.a.error("One-Click App version does not match! Create a GitHub issue please!")}).catch(q.createCatcher())}},{key:"render",value:function(){var e=this,t=this.state.deploymentState,a=this.state.apiData;return a?t?r.a.createElement(ht,{appName:e.props.match.params.appName,deploymentState:t,onFinishClicked:function(){return e.props.history.push("/apps")},onRestartClicked:function(){return e.setState({deploymentState:void 0})}}):r.a.createElement("div",null,r.a.createElement(D.a,{type:"flex",justify:"center"},r.a.createElement(C.a,{span:16},r.a.createElement(U.a,{title:"Setup your ".concat(this.props.match.params.appName)},r.a.createElement("h2",null,this.props.match.params.appName),r.a.createElement("p",{style:{whiteSpace:"pre-line",paddingLeft:15,paddingRight:15}},a.instructions.start),r.a.createElement("div",{style:{height:40}}),r.a.createElement(st,{oneClickAppVariables:a.variables,onNextClicked:function(t){e.oneClickAppDeployHelper.startDeployProcess(e.state.apiData,t),Le()}}))))):r.a.createElement(z,null)}}]),t}(n.Component),gt=S.a.Header,yt=S.a.Content,vt=S.a.Sider,Et=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).mainContainer=r.a.createRef(),a.state={versionInfo:void 0},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;V.isLoggedIn()?this.apiManager.getVersionInfo().then(function(t){e.setState({versionInfo:t})}).catch(q.createCatcher()):this.goToLogin()}},{key:"goToLogin",value:function(){this.props.history.push("/login")}},{key:"createUpdateAvailableIfNeeded",value:function(){var e=this;return e.state.versionInfo&&e.state.versionInfo.canUpdate?r.a.createElement(n.Fragment,null,r.a.createElement(B,{onLinkClicked:function(){return e.props.history.push("/settings")}},r.a.createElement(O.a,{type:"gift",theme:"twoTone",style:{marginLeft:50}}),r.a.createElement(O.a,{type:"gift",theme:"twoTone",style:{marginRight:10,marginLeft:3}}),"Update Available!",r.a.createElement(O.a,{type:"gift",theme:"twoTone",style:{marginLeft:10}}),r.a.createElement(O.a,{type:"gift",theme:"twoTone",style:{marginLeft:3}}))):r.a.createElement("span",null)}},{key:"onSelectMenu",value:function(e){this.props.history.push("/"+e.key)}},{key:"render",value:function(){var e=this;return r.a.createElement(S.a,{className:"full-screen-bg"},r.a.createElement(gt,{className:"header"},r.a.createElement("div",null,r.a.createElement(D.a,null,r.a.createElement(C.a,{span:12},r.a.createElement("span",null,r.a.createElement("h3",{style:{color:"#fff"}},r.a.createElement("img",{src:"/favicon.ico",style:{marginRight:10}}),"CaptainDuckDuck")),e.createUpdateAvailableIfNeeded()),r.a.createElement(C.a,{span:12},r.a.createElement(D.a,{type:"flex",justify:"end"},r.a.createElement("a",{href:"https://github.com/githubsaturn/captainduckduck",target:"_blank",rel:"noopener noreferrer",style:{marginRight:20}},"GitHub"),r.a.createElement("a",{href:"https://captainduckduck.com",target:"_blank",rel:"noopener noreferrer",style:{marginRight:70}},"Docs"),r.a.createElement("span",null,r.a.createElement("span",{style:{border:"1px solid #1b8ad3",borderRadius:5,padding:8}},r.a.createElement(B,{onLinkClicked:function(){e.apiManager.setAuthToken(""),e.goToLogin()}},"Logout ",r.a.createElement(O.a,{type:"logout"}))))))))),r.a.createElement(S.a,null,r.a.createElement(vt,{collapsible:!0,width:200,style:{background:"#fff"}},r.a.createElement(k.a,{onSelect:function(t){e.onSelectMenu(t)},theme:"dark",mode:"inline",defaultSelectedKeys:["dashboard"],style:{height:"100%",borderRight:0}},r.a.createElement(k.a.Item,{key:"dashboard"},r.a.createElement("span",null,r.a.createElement(O.a,{type:"laptop"}),r.a.createElement("span",null,"Dashboard"))),r.a.createElement(k.a.Item,{key:"apps"},r.a.createElement("span",null,r.a.createElement(O.a,{type:"code"}),r.a.createElement("span",null,"Apps"))),r.a.createElement(k.a.Item,{key:"monitoring"},r.a.createElement("span",null,r.a.createElement(O.a,{type:"dashboard"}),r.a.createElement("span",null,"Monitoring"))),r.a.createElement(k.a.Item,{key:"cluster"},r.a.createElement("span",null,r.a.createElement(O.a,{type:"cluster"}),r.a.createElement("span",null,"Cluster"))),r.a.createElement(k.a.Item,{key:"settings"},r.a.createElement("span",null,r.a.createElement(O.a,{type:"setting"}),r.a.createElement("span",null,"Settings"))))),r.a.createElement(yt,null,r.a.createElement("div",{ref:e.mainContainer,style:{paddingTop:12,paddingBottom:36,height:"100%",overflowY:"scroll"},id:"main-content-layout"},r.a.createElement(T.a,null,r.a.createElement(w.a,{path:"/dashboard/",component:Z}),r.a.createElement(w.a,{path:"/apps/details/:appName",render:function(t){return r.a.createElement(_e,Object.assign({},t,{mainContainer:e.mainContainer}))}}),r.a.createElement(w.a,{path:"/apps/oneclick/:appName",component:ft}),r.a.createElement(w.a,{path:"/apps/oneclick",component:ot}),r.a.createElement(w.a,{path:"/apps/",component:Ce}),r.a.createElement(w.a,{path:"/monitoring/",component:Xe}),r.a.createElement(w.a,{path:"/cluster/",component:ye}),r.a.createElement(w.a,{path:"/settings/",component:rt}),r.a.createElement(w.a,{path:"/",component:X}))))))}}]),t}(_),bt=(a(537),a(135)),kt=bt.a.Item,Dt=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"onLoginRequested",value:function(e){var t=this;this.apiManager.getAuthToken(e).then(function(){t.props.history.push("/")}).catch(q.createCatcher())}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%,-50%)"}},r.a.createElement(U.a,{title:"CaptainDuckDuck",style:{width:300}},r.a.createElement(Ot,{onLoginRequested:function(t){return e.onLoginRequested(t)}}))))}}]),t}(_),Ct=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleSubmit=function(e){var t=Object(lt.a)(Object(lt.a)(a));e.preventDefault(),a.props.form.validateFields(function(e,a){e||t.props.onLoginRequested(a.password)})},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return r.a.createElement(bt.a,{onSubmit:this.handleSubmit,className:"login-form"},r.a.createElement(kt,null,e("password",{rules:[{required:!0,message:"Please input your Password!"}]})(r.a.createElement(W.a,{prefix:r.a.createElement(O.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password"}))),r.a.createElement(kt,null,r.a.createElement(H.a,{style:{float:"right"},type:"primary",htmlType:"submit",className:"login-form-button"},"Login")))}}]),t}(r.a.Component),Ot=bt.a.create()(Ct);P().init();var St=Object(m.a)(y.a)(m.d),Tt=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"full-screen-bg"},r.a.createElement(d.a,{store:St(b)},r.a.createElement(h.a,null,r.a.createElement(f.a,null,r.a.createElement(g.a,{path:"/login/",component:Dt}),r.a.createElement(g.a,{path:"/",component:Et})))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(Tt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[246,2,1]]]);
//# sourceMappingURL=main.8c2ea098.chunk.js.map